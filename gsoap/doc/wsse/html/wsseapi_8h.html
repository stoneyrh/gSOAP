<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8">
<meta http-equiv="cache-control" content="no-cache">
<title>Genivia - wsseapi.h File Reference</title>
<link href="genivia_tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="genivia_content.css" rel="stylesheet" type="text/css">
</head>
<body>
<div id="top">
 <div id="titlearea">
  <table height="72px" width="100%" cellspacing="0" cellpadding="0">
   <tbody>
    <tr>
     <td width="10%">&nbsp;</td>
     <td width="175px"><a href="https://www.genivia.com"><img alt="Genivia" src="GeniviaLogo2_trans_noslogan.png"/></a></td>
     <td class="tab_home"><a href="https://www.genivia.com">Home</a></td>
     <td class="tab_home"><a href="https://www.genivia.com/docs.html">Documentation</a></td>
     <td>
      <div style="float: right; font-size: 18px; font-weight: bold;">wsseapi.h File Reference</div>
      <br>
      <div style="float: right; font-size: 10px;">updated Thu Nov 19 2020 by Robert van Engelen</div>
     </td>
     <td width="10%">&nbsp;</td>
    </tr>
   </tbody>
  </table>
 </div>
<!-- Generated by Doxygen 1.8.11 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_b4c3aec6cd8f28418150dce663061cfa.html">plugin</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">wsseapi.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;soapH.h&quot;</code><br />
<code>#include &quot;<a class="el" href="smdevp_8h.html">smdevp.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="mecevp_8h.html">mecevp.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for wsseapi.h:</div>
<div class="dyncontent">
<div class="center"><img src="wsseapi_8h__incl.png" border="0" usemap="#wsseapi_8h" alt=""/></div>
<map name="wsseapi_8h" id="wsseapi_8h">
<area shape="rect" id="node3" href="smdevp_8h.html" title="smdevp.h" alt="" coords="265,80,345,107"/>
<area shape="rect" id="node9" href="mecevp_8h.html" title="mecevp.h" alt="" coords="161,80,241,107"/>
</map>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="wsseapi_8h__dep__incl.png" border="0" usemap="#wsseapi_8hdep" alt=""/></div>
<map name="wsseapi_8hdep" id="wsseapi_8hdep">
<area shape="rect" id="node3" href="wsseapi_8c.html" title="wsseapi.c" alt="" coords="5,83,84,111"/>
</map>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structsoap__wsse__data.html">soap_wsse_data</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">wsseapi plugin data  <a href="structsoap__wsse__data.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structsoap__wsse__digest.html">soap_wsse_digest</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Digest dictionary: linked list of ID-hash pairs.  <a href="structsoap__wsse__digest.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a263bd9819133fc1daccc34458c991ff9"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#a263bd9819133fc1daccc34458c991ff9">SOAP_WSSE_ID</a>&#160;&#160;&#160;&quot;SOAP-WSSE/1.5&quot;</td></tr>
<tr class="separator:a263bd9819133fc1daccc34458c991ff9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae6f973cd88cca2187640822dc86fcd9e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#ae6f973cd88cca2187640822dc86fcd9e">SOAP_WSSE_IGNORE_EXTRA_REFS</a>&#160;&#160;&#160;(0x1000)</td></tr>
<tr class="separator:ae6f973cd88cca2187640822dc86fcd9e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:acdc56c76c1a39c3e6191580d491f9b8e"><td class="memItemLeft" align="right" valign="top">SOAP_FMAC1 struct <a class="el" href="struct__wsse_____security.html">_wsse__Security</a> *SOAP_FMAC2&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#acdc56c76c1a39c3e6191580d491f9b8e">soap_wsse_add_Security</a> (struct soap *soap)</td></tr>
<tr class="memdesc:acdc56c76c1a39c3e6191580d491f9b8e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds Security header element.  <a href="#acdc56c76c1a39c3e6191580d491f9b8e">More...</a><br /></td></tr>
<tr class="separator:acdc56c76c1a39c3e6191580d491f9b8e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a16b318c7c4e19d55a07503d72b49e0d7"><td class="memItemLeft" align="right" valign="top">SOAP_FMAC1 struct <a class="el" href="struct__wsse_____security.html">_wsse__Security</a> *SOAP_FMAC2&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#a16b318c7c4e19d55a07503d72b49e0d7">soap_wsse_add_Security_actor</a> (struct soap *soap, const char *actor)</td></tr>
<tr class="memdesc:a16b318c7c4e19d55a07503d72b49e0d7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds Security header element with actor or role attribute.  <a href="#a16b318c7c4e19d55a07503d72b49e0d7">More...</a><br /></td></tr>
<tr class="separator:a16b318c7c4e19d55a07503d72b49e0d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac06c7021592b2aaca50f73e0de9dec7c"><td class="memItemLeft" align="right" valign="top">SOAP_FMAC1 void SOAP_FMAC2&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#ac06c7021592b2aaca50f73e0de9dec7c">soap_wsse_delete_Security</a> (struct soap *soap)</td></tr>
<tr class="memdesc:ac06c7021592b2aaca50f73e0de9dec7c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Deletes Security header element.  <a href="#ac06c7021592b2aaca50f73e0de9dec7c">More...</a><br /></td></tr>
<tr class="separator:ac06c7021592b2aaca50f73e0de9dec7c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae7775b49a0cd57c7cf85db7bb18b034d"><td class="memItemLeft" align="right" valign="top">SOAP_FMAC1 struct <a class="el" href="struct__wsse_____security.html">_wsse__Security</a> *SOAP_FMAC2&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#ae7775b49a0cd57c7cf85db7bb18b034d">soap_wsse_Security</a> (struct soap *soap)</td></tr>
<tr class="memdesc:ae7775b49a0cd57c7cf85db7bb18b034d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns Security header element if present.  <a href="#ae7775b49a0cd57c7cf85db7bb18b034d">More...</a><br /></td></tr>
<tr class="separator:ae7775b49a0cd57c7cf85db7bb18b034d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7bef911f7276f37c393172d9bf875ffd"><td class="memItemLeft" align="right" valign="top">SOAP_FMAC1 struct <a class="el" href="structds_____signature_type.html">ds__SignatureType</a> *SOAP_FMAC2&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#a7bef911f7276f37c393172d9bf875ffd">soap_wsse_add_Signature</a> (struct soap *soap)</td></tr>
<tr class="memdesc:a7bef911f7276f37c393172d9bf875ffd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds Signature header element.  <a href="#a7bef911f7276f37c393172d9bf875ffd">More...</a><br /></td></tr>
<tr class="separator:a7bef911f7276f37c393172d9bf875ffd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad817f20012b39724f7351909b0b79df2"><td class="memItemLeft" align="right" valign="top">SOAP_FMAC1 void SOAP_FMAC2&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#ad817f20012b39724f7351909b0b79df2">soap_wsse_delete_Signature</a> (struct soap *soap)</td></tr>
<tr class="memdesc:ad817f20012b39724f7351909b0b79df2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Deletes Signature header element.  <a href="#ad817f20012b39724f7351909b0b79df2">More...</a><br /></td></tr>
<tr class="separator:ad817f20012b39724f7351909b0b79df2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a04dd8f3dc19f5ba511f638c59f6b6ee8"><td class="memItemLeft" align="right" valign="top">SOAP_FMAC1 struct <a class="el" href="structds_____signature_type.html">ds__SignatureType</a> *SOAP_FMAC2&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#a04dd8f3dc19f5ba511f638c59f6b6ee8">soap_wsse_Signature</a> (struct soap *soap)</td></tr>
<tr class="memdesc:a04dd8f3dc19f5ba511f638c59f6b6ee8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns Signature header element if present.  <a href="#a04dd8f3dc19f5ba511f638c59f6b6ee8">More...</a><br /></td></tr>
<tr class="separator:a04dd8f3dc19f5ba511f638c59f6b6ee8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a71fe27aee76db1d0a635afe106d8b109"><td class="memItemLeft" align="right" valign="top">SOAP_FMAC1 int SOAP_FMAC2&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#a71fe27aee76db1d0a635afe106d8b109">soap_wsse_add_Timestamp</a> (struct soap *soap, const char *id, time_t lifetime)</td></tr>
<tr class="memdesc:a71fe27aee76db1d0a635afe106d8b109"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds Timestamp element with optional expiration date+time (lifetime).  <a href="#a71fe27aee76db1d0a635afe106d8b109">More...</a><br /></td></tr>
<tr class="separator:a71fe27aee76db1d0a635afe106d8b109"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a04c4d2e02fd8580ff632410f918f7796"><td class="memItemLeft" align="right" valign="top">SOAP_FMAC1 struct <a class="el" href="struct__wsu_____timestamp.html">_wsu__Timestamp</a> *SOAP_FMAC2&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#a04c4d2e02fd8580ff632410f918f7796">soap_wsse_Timestamp</a> (struct soap *soap)</td></tr>
<tr class="memdesc:a04c4d2e02fd8580ff632410f918f7796"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns Timestamp element if present.  <a href="#a04c4d2e02fd8580ff632410f918f7796">More...</a><br /></td></tr>
<tr class="separator:a04c4d2e02fd8580ff632410f918f7796"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a98422cde0e2b7b14d65212f7061101fa"><td class="memItemLeft" align="right" valign="top">SOAP_FMAC1 int SOAP_FMAC2&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#a98422cde0e2b7b14d65212f7061101fa">soap_wsse_verify_Timestamp</a> (struct soap *soap)</td></tr>
<tr class="memdesc:a98422cde0e2b7b14d65212f7061101fa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Verifies the Timestamp/Expires element against the current time.  <a href="#a98422cde0e2b7b14d65212f7061101fa">More...</a><br /></td></tr>
<tr class="separator:a98422cde0e2b7b14d65212f7061101fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a37f32e51bceabf2e2823516a1737548f"><td class="memItemLeft" align="right" valign="top">SOAP_FMAC1 int SOAP_FMAC2&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#a37f32e51bceabf2e2823516a1737548f">soap_wsse_add_UsernameTokenText</a> (struct soap *soap, const char *id, const char *username, const char *password)</td></tr>
<tr class="memdesc:a37f32e51bceabf2e2823516a1737548f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds UsernameToken element with optional clear-text password.  <a href="#a37f32e51bceabf2e2823516a1737548f">More...</a><br /></td></tr>
<tr class="separator:a37f32e51bceabf2e2823516a1737548f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac9fe59008bdf12d7a007ac48e6ebb613"><td class="memItemLeft" align="right" valign="top">SOAP_FMAC1 int SOAP_FMAC2&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#ac9fe59008bdf12d7a007ac48e6ebb613">soap_wsse_add_UsernameTokenDigest</a> (struct soap *soap, const char *id, const char *username, const char *password)</td></tr>
<tr class="memdesc:ac9fe59008bdf12d7a007ac48e6ebb613"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds UsernameToken element for digest authentication.  <a href="#ac9fe59008bdf12d7a007ac48e6ebb613">More...</a><br /></td></tr>
<tr class="separator:ac9fe59008bdf12d7a007ac48e6ebb613"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7204edbdd78caf5f1e26f0244e0214ee"><td class="memItemLeft" align="right" valign="top">SOAP_FMAC1 int SOAP_FMAC2&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#a7204edbdd78caf5f1e26f0244e0214ee">soap_wsse_add_UsernameTokenDigest_at</a> (struct soap *soap, const char *id, const char *username, const char *password, time_t when)</td></tr>
<tr class="memdesc:a7204edbdd78caf5f1e26f0244e0214ee"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds UsernameToken element for digest authentication.  <a href="#a7204edbdd78caf5f1e26f0244e0214ee">More...</a><br /></td></tr>
<tr class="separator:a7204edbdd78caf5f1e26f0244e0214ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae74d27ca59d97961711a038b7188ceb6"><td class="memItemLeft" align="right" valign="top">SOAP_FMAC1 struct <a class="el" href="struct__wsse_____username_token.html">_wsse__UsernameToken</a> *SOAP_FMAC2&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#ae74d27ca59d97961711a038b7188ceb6">soap_wsse_UsernameToken</a> (struct soap *soap, const char *id)</td></tr>
<tr class="memdesc:ae74d27ca59d97961711a038b7188ceb6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns UsernameToken element if present.  <a href="#ae74d27ca59d97961711a038b7188ceb6">More...</a><br /></td></tr>
<tr class="separator:ae74d27ca59d97961711a038b7188ceb6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca3fe6fb7c1e5c103827b33f24292f47"><td class="memItemLeft" align="right" valign="top">SOAP_FMAC1 const char *SOAP_FMAC2&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#aca3fe6fb7c1e5c103827b33f24292f47">soap_wsse_get_Username</a> (struct soap *soap)</td></tr>
<tr class="memdesc:aca3fe6fb7c1e5c103827b33f24292f47"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns UsernameToken/username string or wsse:FailedAuthentication fault.  <a href="#aca3fe6fb7c1e5c103827b33f24292f47">More...</a><br /></td></tr>
<tr class="separator:aca3fe6fb7c1e5c103827b33f24292f47"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb0afd01a5036e4f1314a3cfe8575bd5"><td class="memItemLeft" align="right" valign="top">SOAP_FMAC1 int SOAP_FMAC2&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#aeb0afd01a5036e4f1314a3cfe8575bd5">soap_wsse_verify_Password</a> (struct soap *soap, const char *password)</td></tr>
<tr class="memdesc:aeb0afd01a5036e4f1314a3cfe8575bd5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Verifies the supplied password or sets wsse:FailedAuthentication fault.  <a href="#aeb0afd01a5036e4f1314a3cfe8575bd5">More...</a><br /></td></tr>
<tr class="separator:aeb0afd01a5036e4f1314a3cfe8575bd5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a272ece3d02d7fbb5309cda9d1b252822"><td class="memItemLeft" align="right" valign="top">SOAP_FMAC1 int SOAP_FMAC2&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#a272ece3d02d7fbb5309cda9d1b252822">soap_wsse_add_BinarySecurityToken</a> (struct soap *soap, const char *id, const char *valueType, const unsigned char *data, int size)</td></tr>
<tr class="memdesc:a272ece3d02d7fbb5309cda9d1b252822"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds BinarySecurityToken element.  <a href="#a272ece3d02d7fbb5309cda9d1b252822">More...</a><br /></td></tr>
<tr class="separator:a272ece3d02d7fbb5309cda9d1b252822"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a53075fb3cec4ec4e70fb11850fecb401"><td class="memItemLeft" align="right" valign="top">SOAP_FMAC1 int SOAP_FMAC2&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#a53075fb3cec4ec4e70fb11850fecb401">soap_wsse_add_BinarySecurityTokenX509</a> (struct soap *soap, const char *id, X509 *cert)</td></tr>
<tr class="memdesc:a53075fb3cec4ec4e70fb11850fecb401"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds BinarySecurityToken element with X509 certificate.  <a href="#a53075fb3cec4ec4e70fb11850fecb401">More...</a><br /></td></tr>
<tr class="separator:a53075fb3cec4ec4e70fb11850fecb401"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad88d8317bcbbcda4cdc8d1bcfb2e0f18"><td class="memItemLeft" align="right" valign="top">SOAP_FMAC1 int SOAP_FMAC2&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#ad88d8317bcbbcda4cdc8d1bcfb2e0f18">soap_wsse_add_BinarySecurityTokenPEM</a> (struct soap *soap, const char *id, const char *filename)</td></tr>
<tr class="memdesc:ad88d8317bcbbcda4cdc8d1bcfb2e0f18"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds BinarySecurityToken element from a PEM file.  <a href="#ad88d8317bcbbcda4cdc8d1bcfb2e0f18">More...</a><br /></td></tr>
<tr class="separator:ad88d8317bcbbcda4cdc8d1bcfb2e0f18"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaff2b8d3e40827341ac0382cd501c04b"><td class="memItemLeft" align="right" valign="top">SOAP_FMAC1 struct <a class="el" href="struct__wsse_____binary_security_token.html">_wsse__BinarySecurityToken</a> *SOAP_FMAC2&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#aaff2b8d3e40827341ac0382cd501c04b">soap_wsse_BinarySecurityToken</a> (struct soap *soap, const char *id)</td></tr>
<tr class="memdesc:aaff2b8d3e40827341ac0382cd501c04b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns BinarySecurityToken element if present.  <a href="#aaff2b8d3e40827341ac0382cd501c04b">More...</a><br /></td></tr>
<tr class="separator:aaff2b8d3e40827341ac0382cd501c04b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7496da1dd76aa06e6657365b5c7dd76d"><td class="memItemLeft" align="right" valign="top">SOAP_FMAC1 int SOAP_FMAC2&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#a7496da1dd76aa06e6657365b5c7dd76d">soap_wsse_get_BinarySecurityToken</a> (struct soap *soap, const char *id, char **valueType, unsigned char **data, int *size)</td></tr>
<tr class="memdesc:a7496da1dd76aa06e6657365b5c7dd76d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get wsse:BinarySecurityToken element token data in binary form.  <a href="#a7496da1dd76aa06e6657365b5c7dd76d">More...</a><br /></td></tr>
<tr class="separator:a7496da1dd76aa06e6657365b5c7dd76d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2ec22f47b0c66b62ef3c96d8f7b31436"><td class="memItemLeft" align="right" valign="top">SOAP_FMAC1 X509 *SOAP_FMAC2&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#a2ec22f47b0c66b62ef3c96d8f7b31436">soap_wsse_get_BinarySecurityTokenX509</a> (struct soap *soap, const char *id)</td></tr>
<tr class="memdesc:a2ec22f47b0c66b62ef3c96d8f7b31436"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get X509 wsse:BinarySecurityToken certificate and verify its content. This call must be followed by an X509_free to deallocate the X509 certificate data.  <a href="#a2ec22f47b0c66b62ef3c96d8f7b31436">More...</a><br /></td></tr>
<tr class="separator:a2ec22f47b0c66b62ef3c96d8f7b31436"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f5879e7d5bd3580ea400ccd1982d747"><td class="memItemLeft" align="right" valign="top">SOAP_FMAC1 int SOAP_FMAC2&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#a8f5879e7d5bd3580ea400ccd1982d747">soap_wsse_verify_X509</a> (struct soap *soap, X509 *cert)</td></tr>
<tr class="memdesc:a8f5879e7d5bd3580ea400ccd1982d747"><td class="mdescLeft">&#160;</td><td class="mdescRight">Verifies X509 certificate against soap-&gt;cafile, soap-&gt;capath, and soap-&gt;crlfile.  <a href="#a8f5879e7d5bd3580ea400ccd1982d747">More...</a><br /></td></tr>
<tr class="separator:a8f5879e7d5bd3580ea400ccd1982d747"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4941ccab15e473e979ff4b3a926c04bb"><td class="memItemLeft" align="right" valign="top">SOAP_FMAC1 int SOAP_FMAC2&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#a4941ccab15e473e979ff4b3a926c04bb">soap_wsse_add_SecurityContextToken</a> (struct soap *soap, const char *id, const char *identifier)</td></tr>
<tr class="memdesc:a4941ccab15e473e979ff4b3a926c04bb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds wsc:SecurityContextToken/Identifier and SecurityTokenReference to it.  <a href="#a4941ccab15e473e979ff4b3a926c04bb">More...</a><br /></td></tr>
<tr class="separator:a4941ccab15e473e979ff4b3a926c04bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af64d7a9e7d03a291e1421459ca227254"><td class="memItemLeft" align="right" valign="top">SOAP_FMAC1 const char *SOAP_FMAC2&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#af64d7a9e7d03a291e1421459ca227254">soap_wsse_get_SecurityContextToken</a> (struct soap *soap)</td></tr>
<tr class="memdesc:af64d7a9e7d03a291e1421459ca227254"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns wsc:SecurityContextToken/Identifier string value or NULL.  <a href="#af64d7a9e7d03a291e1421459ca227254">More...</a><br /></td></tr>
<tr class="separator:af64d7a9e7d03a291e1421459ca227254"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a0471df1dd7192cd6541c9eb5d58512"><td class="memItemLeft" align="right" valign="top">SOAP_FMAC1 struct <a class="el" href="structds_____signed_info_type.html">ds__SignedInfoType</a> *SOAP_FMAC2&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#a0a0471df1dd7192cd6541c9eb5d58512">soap_wsse_add_SignedInfo</a> (struct soap *soap)</td></tr>
<tr class="memdesc:a0a0471df1dd7192cd6541c9eb5d58512"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds SignedInfo element.  <a href="#a0a0471df1dd7192cd6541c9eb5d58512">More...</a><br /></td></tr>
<tr class="separator:a0a0471df1dd7192cd6541c9eb5d58512"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f987fb35c08ea173e81fdf27e599b87"><td class="memItemLeft" align="right" valign="top">SOAP_FMAC1 int SOAP_FMAC2&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#a2f987fb35c08ea173e81fdf27e599b87">soap_wsse_add_SignedInfo_Reference</a> (struct soap *soap, const char *URI, unsigned int level, const char *transform, const char *inclusiveNamespaces, int alg, const char *HA)</td></tr>
<tr class="memdesc:a2f987fb35c08ea173e81fdf27e599b87"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds SignedInfo element with Reference URI, transform algorithm used, and digest value.  <a href="#a2f987fb35c08ea173e81fdf27e599b87">More...</a><br /></td></tr>
<tr class="separator:a2f987fb35c08ea173e81fdf27e599b87"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a398f98d62dfba91d04cff19230fb6722"><td class="memItemLeft" align="right" valign="top">SOAP_FMAC1 int SOAP_FMAC2&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#a398f98d62dfba91d04cff19230fb6722">soap_wsse_add_SignedInfo_SignatureMethod</a> (struct soap *soap, const char *method, int canonical)</td></tr>
<tr class="memdesc:a398f98d62dfba91d04cff19230fb6722"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds SignedInfo element with SignatureMethod.  <a href="#a398f98d62dfba91d04cff19230fb6722">More...</a><br /></td></tr>
<tr class="separator:a398f98d62dfba91d04cff19230fb6722"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a98940306a4dd6074efc2e3ff9c899ba9"><td class="memItemLeft" align="right" valign="top">SOAP_FMAC1 struct <a class="el" href="structds_____signed_info_type.html">ds__SignedInfoType</a> *SOAP_FMAC2&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#a98940306a4dd6074efc2e3ff9c899ba9">soap_wsse_SignedInfo</a> (struct soap *soap)</td></tr>
<tr class="memdesc:a98940306a4dd6074efc2e3ff9c899ba9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns SignedInfo element if present.  <a href="#a98940306a4dd6074efc2e3ff9c899ba9">More...</a><br /></td></tr>
<tr class="separator:a98940306a4dd6074efc2e3ff9c899ba9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a09e16b1618a55f17603691ba3c27dea0"><td class="memItemLeft" align="right" valign="top">SOAP_FMAC1 int SOAP_FMAC2&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#a09e16b1618a55f17603691ba3c27dea0">soap_wsse_get_SignedInfo_SignatureMethod</a> (struct soap *soap, int *alg, int *bits)</td></tr>
<tr class="memdesc:a09e16b1618a55f17603691ba3c27dea0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get SignatureMethod algorithm.  <a href="#a09e16b1618a55f17603691ba3c27dea0">More...</a><br /></td></tr>
<tr class="separator:a09e16b1618a55f17603691ba3c27dea0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7399c40e0019bc1ae797fccf92f81fc7"><td class="memItemLeft" align="right" valign="top">SOAP_FMAC1 int SOAP_FMAC2&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#a7399c40e0019bc1ae797fccf92f81fc7">soap_wsse_add_SignatureValue</a> (struct soap *soap, int alg, const void *key, int keylen)</td></tr>
<tr class="memdesc:a7399c40e0019bc1ae797fccf92f81fc7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds SignedInfo/SignatureMethod element, signs the SignedInfo element, and adds the resulting SignatureValue element.  <a href="#a7399c40e0019bc1ae797fccf92f81fc7">More...</a><br /></td></tr>
<tr class="separator:a7399c40e0019bc1ae797fccf92f81fc7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1267cd7ba1fa1dc0f38fd75f74503308"><td class="memItemLeft" align="right" valign="top">SOAP_FMAC1 int SOAP_FMAC2&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#a1267cd7ba1fa1dc0f38fd75f74503308">soap_wsse_verify_Signature</a> (struct soap *soap)</td></tr>
<tr class="memdesc:a1267cd7ba1fa1dc0f38fd75f74503308"><td class="mdescLeft">&#160;</td><td class="mdescRight">Verifies the Signature and the signed elements.  <a href="#a1267cd7ba1fa1dc0f38fd75f74503308">More...</a><br /></td></tr>
<tr class="separator:a1267cd7ba1fa1dc0f38fd75f74503308"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8ab7e709b0423cd68d3fec96b3db3734"><td class="memItemLeft" align="right" valign="top">SOAP_FMAC1 int SOAP_FMAC2&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#a8ab7e709b0423cd68d3fec96b3db3734">soap_wsse_verify_SignatureValue</a> (struct soap *soap, int alg, const void *key, int keylen)</td></tr>
<tr class="memdesc:a8ab7e709b0423cd68d3fec96b3db3734"><td class="mdescLeft">&#160;</td><td class="mdescRight">Verifies the SignatureValue of a SignedInfo element.  <a href="#a8ab7e709b0423cd68d3fec96b3db3734">More...</a><br /></td></tr>
<tr class="separator:a8ab7e709b0423cd68d3fec96b3db3734"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a75b7ca484637dfc49143546072dd5f4b"><td class="memItemLeft" align="right" valign="top">SOAP_FMAC1 int SOAP_FMAC2&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#a75b7ca484637dfc49143546072dd5f4b">soap_wsse_verify_SignedInfo</a> (struct soap *soap)</td></tr>
<tr class="memdesc:a75b7ca484637dfc49143546072dd5f4b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Verifies the digest values of the XML elements referenced by the SignedInfo References.  <a href="#a75b7ca484637dfc49143546072dd5f4b">More...</a><br /></td></tr>
<tr class="separator:a75b7ca484637dfc49143546072dd5f4b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acf1c213ea26a2286f9c0457849bd6290"><td class="memItemLeft" align="right" valign="top">SOAP_FMAC1 int SOAP_FMAC2&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#acf1c213ea26a2286f9c0457849bd6290">soap_wsse_verify_digest</a> (struct soap *soap, int alg, int canonical, const char *id, unsigned char hash[<a class="el" href="smdevp_8h.html#a9f9c621fe70ba4eba05b9120acc16f5c">SOAP_SMD_MAX_SIZE</a>])</td></tr>
<tr class="memdesc:acf1c213ea26a2286f9c0457849bd6290"><td class="mdescLeft">&#160;</td><td class="mdescRight">Verifies the digest value of an XML element referenced by id against the hash.  <a href="#acf1c213ea26a2286f9c0457849bd6290">More...</a><br /></td></tr>
<tr class="separator:acf1c213ea26a2286f9c0457849bd6290"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a66938fb25c79caddb31d4e6c8ff443d2"><td class="memItemLeft" align="right" valign="top">SOAP_FMAC1 struct <a class="el" href="structds_____key_info_type.html">ds__KeyInfoType</a> *SOAP_FMAC2&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#a66938fb25c79caddb31d4e6c8ff443d2">soap_wsse_add_KeyInfo</a> (struct soap *soap)</td></tr>
<tr class="memdesc:a66938fb25c79caddb31d4e6c8ff443d2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds KeyInfo element.  <a href="#a66938fb25c79caddb31d4e6c8ff443d2">More...</a><br /></td></tr>
<tr class="separator:a66938fb25c79caddb31d4e6c8ff443d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afd81efa4868e56854ec3552252641711"><td class="memItemLeft" align="right" valign="top">SOAP_FMAC1 struct <a class="el" href="structds_____key_info_type.html">ds__KeyInfoType</a> *SOAP_FMAC2&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#afd81efa4868e56854ec3552252641711">soap_wsse_KeyInfo</a> (struct soap *soap)</td></tr>
<tr class="memdesc:afd81efa4868e56854ec3552252641711"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns KeyInfo element if present.  <a href="#afd81efa4868e56854ec3552252641711">More...</a><br /></td></tr>
<tr class="separator:afd81efa4868e56854ec3552252641711"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a25240140007f1776479e81dd43457f40"><td class="memItemLeft" align="right" valign="top">SOAP_FMAC1 int SOAP_FMAC2&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#a25240140007f1776479e81dd43457f40">soap_wsse_add_KeyInfo_KeyName</a> (struct soap *soap, const char *name)</td></tr>
<tr class="memdesc:a25240140007f1776479e81dd43457f40"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds KeyName element.  <a href="#a25240140007f1776479e81dd43457f40">More...</a><br /></td></tr>
<tr class="separator:a25240140007f1776479e81dd43457f40"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae2d977152d826e17bbc58cbd4fddf27a"><td class="memItemLeft" align="right" valign="top">SOAP_FMAC1 const char *SOAP_FMAC2&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#ae2d977152d826e17bbc58cbd4fddf27a">soap_wsse_get_KeyInfo_KeyName</a> (struct soap *soap)</td></tr>
<tr class="memdesc:ae2d977152d826e17bbc58cbd4fddf27a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns KeyName element if present.  <a href="#ae2d977152d826e17bbc58cbd4fddf27a">More...</a><br /></td></tr>
<tr class="separator:ae2d977152d826e17bbc58cbd4fddf27a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa1557c59801a0c3e4a77c1cb56cc2d9e"><td class="memItemLeft" align="right" valign="top">SOAP_FMAC1 int SOAP_FMAC2&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#aa1557c59801a0c3e4a77c1cb56cc2d9e">soap_wsse_add_KeyInfo_SecurityTokenReferenceURI</a> (struct soap *soap, const char *URI, const char *valueType)</td></tr>
<tr class="memdesc:aa1557c59801a0c3e4a77c1cb56cc2d9e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds KeyInfo element with SecurityTokenReference URI.  <a href="#aa1557c59801a0c3e4a77c1cb56cc2d9e">More...</a><br /></td></tr>
<tr class="separator:aa1557c59801a0c3e4a77c1cb56cc2d9e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a72df80abd1d36cea516feda3a84672cf"><td class="memItemLeft" align="right" valign="top">SOAP_FMAC1 int SOAP_FMAC2&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#a72df80abd1d36cea516feda3a84672cf">soap_wsse_add_KeyInfo_SecurityTokenReferenceX509</a> (struct soap *soap, const char *URI)</td></tr>
<tr class="memdesc:a72df80abd1d36cea516feda3a84672cf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds KeyInfo element with SecurityTokenReference URI to an X509 cert.  <a href="#a72df80abd1d36cea516feda3a84672cf">More...</a><br /></td></tr>
<tr class="separator:a72df80abd1d36cea516feda3a84672cf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0564dbedcbf4e6404c51d14db61db5cb"><td class="memItemLeft" align="right" valign="top">SOAP_FMAC1 const char *SOAP_FMAC2&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#a0564dbedcbf4e6404c51d14db61db5cb">soap_wsse_get_KeyInfo_SecurityTokenReferenceURI</a> (struct soap *soap)</td></tr>
<tr class="memdesc:a0564dbedcbf4e6404c51d14db61db5cb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns a SecurityTokenReference URI if present.  <a href="#a0564dbedcbf4e6404c51d14db61db5cb">More...</a><br /></td></tr>
<tr class="separator:a0564dbedcbf4e6404c51d14db61db5cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a53165ba9f316163972af9a839a84da1f"><td class="memItemLeft" align="right" valign="top">SOAP_FMAC1 const char *SOAP_FMAC2&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#a53165ba9f316163972af9a839a84da1f">soap_wsse_get_KeyInfo_SecurityTokenReferenceValueType</a> (struct soap *soap)</td></tr>
<tr class="memdesc:a53165ba9f316163972af9a839a84da1f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns a SecurityTokenReference ValueType if present.  <a href="#a53165ba9f316163972af9a839a84da1f">More...</a><br /></td></tr>
<tr class="separator:a53165ba9f316163972af9a839a84da1f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa35a9b6b69417f40c248cdae560a3dfc"><td class="memItemLeft" align="right" valign="top">SOAP_FMAC1 X509 *SOAP_FMAC2&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#aa35a9b6b69417f40c248cdae560a3dfc">soap_wsse_get_KeyInfo_SecurityTokenReferenceX509</a> (struct soap *soap)</td></tr>
<tr class="memdesc:aa35a9b6b69417f40c248cdae560a3dfc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns a X509 certificate when referenced and present as a BinarySecurity token or when embedded in the signature KeyIdentifier or KeyInfo element. This call must be followed by an X509_free to deallocate the X509 certificate data.  <a href="#aa35a9b6b69417f40c248cdae560a3dfc">More...</a><br /></td></tr>
<tr class="separator:aa35a9b6b69417f40c248cdae560a3dfc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe67a8a00c79480f83078c04ab2d1fc3"><td class="memItemLeft" align="right" valign="top">SOAP_FMAC1 int SOAP_FMAC2&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#abe67a8a00c79480f83078c04ab2d1fc3">soap_wsse_add_KeyInfo_X509Certificate</a> (struct soap *soap, X509 *cert)</td></tr>
<tr class="memdesc:abe67a8a00c79480f83078c04ab2d1fc3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds KeyInfo/X509Data/X509Certificate.  <a href="#abe67a8a00c79480f83078c04ab2d1fc3">More...</a><br /></td></tr>
<tr class="separator:abe67a8a00c79480f83078c04ab2d1fc3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2346304c77d35bd6fb849c8c0e8cea13"><td class="memItemLeft" align="right" valign="top">SOAP_FMAC1 struct <a class="el" href="structds_____x509_issuer_serial_type.html">ds__X509IssuerSerialType</a> *SOAP_FMAC2&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#a2346304c77d35bd6fb849c8c0e8cea13">soap_wsse_get_KeyInfo_SecurityTokenReferenceX509Data</a> (struct soap *soap)</td></tr>
<tr class="memdesc:a2346304c77d35bd6fb849c8c0e8cea13"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns <a class="el" href="structds_____x509_issuer_serial_type.html" title="&quot;http://www.w3.org/2000/09/xmldsig#&quot;:X509IssuerSerialType is a complexType. ">ds__X509IssuerSerialType</a> with non-NULL X509IssuerName and non-NULL X509SerialNumber of a X509Data element when present and set.  <a href="#a2346304c77d35bd6fb849c8c0e8cea13">More...</a><br /></td></tr>
<tr class="separator:a2346304c77d35bd6fb849c8c0e8cea13"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a83ad7822556d691020209fa12d1c79a7"><td class="memItemLeft" align="right" valign="top">SOAP_FMAC1 int SOAP_FMAC2&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#a83ad7822556d691020209fa12d1c79a7">soap_wsse_add_KeyInfo_SecurityTokenReferenceKeyIdentifier</a> (struct soap *soap, const char *id, const char *valueType, unsigned char *data, int size)</td></tr>
<tr class="memdesc:a83ad7822556d691020209fa12d1c79a7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds KeyInfo element with SecurityTokenReference/KeyIdentifier binary data.  <a href="#a83ad7822556d691020209fa12d1c79a7">More...</a><br /></td></tr>
<tr class="separator:a83ad7822556d691020209fa12d1c79a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad3162057a523357a05c9916ba272c139"><td class="memItemLeft" align="right" valign="top">SOAP_FMAC1 const char *SOAP_FMAC2&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#ad3162057a523357a05c9916ba272c139">soap_wsse_get_KeyInfo_SecurityTokenReferenceKeyIdentifierValueType</a> (struct soap *soap, <a class="el" href="structds_____key_info_type.html">ds__KeyInfoType</a> *keyInfo)</td></tr>
<tr class="memdesc:ad3162057a523357a05c9916ba272c139"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns KeyInfo/SecurityTokenReference/KeyIdentifier/ValueType if present.  <a href="#ad3162057a523357a05c9916ba272c139">More...</a><br /></td></tr>
<tr class="separator:ad3162057a523357a05c9916ba272c139"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a00685f74272f1e5e213e274d004108bc"><td class="memItemLeft" align="right" valign="top">SOAP_FMAC1 const unsigned char *SOAP_FMAC2&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#a00685f74272f1e5e213e274d004108bc">soap_wsse_get_KeyInfo_SecurityTokenReferenceKeyIdentifier</a> (struct soap *soap, <a class="el" href="structds_____key_info_type.html">ds__KeyInfoType</a> *keyInfo, int *size)</td></tr>
<tr class="memdesc:a00685f74272f1e5e213e274d004108bc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns KeyInfo/SecurityTokenReference/KeyIdentifier binary data.  <a href="#a00685f74272f1e5e213e274d004108bc">More...</a><br /></td></tr>
<tr class="separator:a00685f74272f1e5e213e274d004108bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8fcf5947eb011d73b6a6b1308123a536"><td class="memItemLeft" align="right" valign="top">SOAP_FMAC1 int SOAP_FMAC2&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#a8fcf5947eb011d73b6a6b1308123a536">soap_wsse_add_KeyInfo_SecurityTokenReferenceEmbedded</a> (struct soap *soap, const char *id, const char *valueType)</td></tr>
<tr class="memdesc:a8fcf5947eb011d73b6a6b1308123a536"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds KeyInfo element with Embedded SecurityTokenReference.  <a href="#a8fcf5947eb011d73b6a6b1308123a536">More...</a><br /></td></tr>
<tr class="separator:a8fcf5947eb011d73b6a6b1308123a536"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0569043138de574a8f61f45b608971ad"><td class="memItemLeft" align="right" valign="top">SOAP_FMAC1 int SOAP_FMAC2&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#a0569043138de574a8f61f45b608971ad">soap_wsse_add_EncryptedData_KeyInfo_KeyName</a> (struct soap *soap, const char *keyname)</td></tr>
<tr class="memdesc:a0569043138de574a8f61f45b608971ad"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds EncryptedData/ds:KeyInfo/Keyname elements.  <a href="#a0569043138de574a8f61f45b608971ad">More...</a><br /></td></tr>
<tr class="separator:a0569043138de574a8f61f45b608971ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aac4234bd51599c36aec7bf7888191fb0"><td class="memItemLeft" align="right" valign="top">SOAP_FMAC1 int SOAP_FMAC2&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#aac4234bd51599c36aec7bf7888191fb0">soap_wsse_sender_fault_subcode</a> (struct soap *soap, const char *faultsubcode, const char *faultstring, const char *faultdetail)</td></tr>
<tr class="memdesc:aac4234bd51599c36aec7bf7888191fb0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets sender SOAP Fault (sub)code for server fault response.  <a href="#aac4234bd51599c36aec7bf7888191fb0">More...</a><br /></td></tr>
<tr class="separator:aac4234bd51599c36aec7bf7888191fb0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5cec82648247163c63a28d624b2b9fe8"><td class="memItemLeft" align="right" valign="top">SOAP_FMAC1 int SOAP_FMAC2&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#a5cec82648247163c63a28d624b2b9fe8">soap_wsse_receiver_fault_subcode</a> (struct soap *soap, const char *faultsubcode, const char *faultstring, const char *faultdetail)</td></tr>
<tr class="memdesc:a5cec82648247163c63a28d624b2b9fe8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets receiver SOAP Fault (sub)code for server fault response.  <a href="#a5cec82648247163c63a28d624b2b9fe8">More...</a><br /></td></tr>
<tr class="separator:a5cec82648247163c63a28d624b2b9fe8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0e7d820ea5bf71efb136bb7f0ffbb71f"><td class="memItemLeft" align="right" valign="top">SOAP_FMAC1 int SOAP_FMAC2&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#a0e7d820ea5bf71efb136bb7f0ffbb71f">soap_wsse_sender_fault</a> (struct soap *soap, const char *faultstring, const char *faultdetail)</td></tr>
<tr class="memdesc:a0e7d820ea5bf71efb136bb7f0ffbb71f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets sender SOAP Fault for server fault response.  <a href="#a0e7d820ea5bf71efb136bb7f0ffbb71f">More...</a><br /></td></tr>
<tr class="separator:a0e7d820ea5bf71efb136bb7f0ffbb71f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7590c46443ff1c74365091d2d7806829"><td class="memItemLeft" align="right" valign="top">SOAP_FMAC1 int SOAP_FMAC2&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#a7590c46443ff1c74365091d2d7806829">soap_wsse_receiver_fault</a> (struct soap *soap, const char *faultstring, const char *faultdetail)</td></tr>
<tr class="memdesc:a7590c46443ff1c74365091d2d7806829"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets receiver SOAP Fault for server fault response.  <a href="#a7590c46443ff1c74365091d2d7806829">More...</a><br /></td></tr>
<tr class="separator:a7590c46443ff1c74365091d2d7806829"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af333975761fe6c00031a223a2036311b"><td class="memItemLeft" align="right" valign="top">SOAP_FMAC1 int SOAP_FMAC2&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#af333975761fe6c00031a223a2036311b">soap_wsse_fault</a> (struct soap *soap, enum <a class="el" href="wsse_8h.html#aaade5f4816d66546a0817dade206f50f">wsse__FaultcodeEnum</a> fault, const char *detail)</td></tr>
<tr class="memdesc:af333975761fe6c00031a223a2036311b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets SOAP Fault (sub)code for server response.  <a href="#af333975761fe6c00031a223a2036311b">More...</a><br /></td></tr>
<tr class="separator:af333975761fe6c00031a223a2036311b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af15bedb61bffb589683354bc37d20c3a"><td class="memItemLeft" align="right" valign="top">SOAP_FMAC1 int SOAP_FMAC2&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#af15bedb61bffb589683354bc37d20c3a">soap_wsse</a> (struct soap *soap, struct soap_plugin *p, void *arg)</td></tr>
<tr class="memdesc:af15bedb61bffb589683354bc37d20c3a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Plugin registry function, used with soap_register_plugin.  <a href="#af15bedb61bffb589683354bc37d20c3a">More...</a><br /></td></tr>
<tr class="separator:af15bedb61bffb589683354bc37d20c3a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb37bd1642b6028f96f99ef7e9525c12"><td class="memItemLeft" align="right" valign="top">SOAP_FMAC1 void SOAP_FMAC2&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#abb37bd1642b6028f96f99ef7e9525c12">soap_wsse_rand_nonce</a> (char *nonce, size_t noncelen)</td></tr>
<tr class="memdesc:abb37bd1642b6028f96f99ef7e9525c12"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates randomized nonce.  <a href="#abb37bd1642b6028f96f99ef7e9525c12">More...</a><br /></td></tr>
<tr class="separator:abb37bd1642b6028f96f99ef7e9525c12"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0e8a5373312b996b931fd521cd42fdaf"><td class="memItemLeft" align="right" valign="top">SOAP_FMAC1 int SOAP_FMAC2&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#a0e8a5373312b996b931fd521cd42fdaf">soap_pmd5</a> (struct soap *soap, const char *hmac_key, size_t hmac_key_len, const char *secret, size_t secretlen, char *pmd5, size_t pmd5len)</td></tr>
<tr class="memdesc:a0e8a5373312b996b931fd521cd42fdaf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes PMD5(hmac_key[0..hmac_key_len-1], secret[0..secretlen-1], pmd5[0..pmd5len-1]).  <a href="#a0e8a5373312b996b931fd521cd42fdaf">More...</a><br /></td></tr>
<tr class="separator:a0e8a5373312b996b931fd521cd42fdaf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1992e3ad46bc687b95f0917e86c5b9a5"><td class="memItemLeft" align="right" valign="top">SOAP_FMAC1 int SOAP_FMAC2&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#a1992e3ad46bc687b95f0917e86c5b9a5">soap_psha1</a> (struct soap *soap, const char *hmac_key, size_t hmac_key_len, const char *secret, size_t secretlen, char *psha1, size_t psha1len)</td></tr>
<tr class="memdesc:a1992e3ad46bc687b95f0917e86c5b9a5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes PSHA1(hmac_key[0..hmac_key_len-1], secret[0..secretlen-1], psha1[0..psha1len-1]).  <a href="#a1992e3ad46bc687b95f0917e86c5b9a5">More...</a><br /></td></tr>
<tr class="separator:a1992e3ad46bc687b95f0917e86c5b9a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac80f6d496557fff8dbd1dd906030c85a"><td class="memItemLeft" align="right" valign="top">SOAP_FMAC1 int SOAP_FMAC2&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#ac80f6d496557fff8dbd1dd906030c85a">soap_psha256</a> (struct soap *soap, const char *hmac_key, size_t hmac_key_len, const char *secret, size_t secretlen, char *psha256, size_t psha256len)</td></tr>
<tr class="memdesc:ac80f6d496557fff8dbd1dd906030c85a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes PSHA256(hmac_key[0..hmac_key_len-1], secret[0..secretlen-1], psha256[0..psha256len-1]).  <a href="#ac80f6d496557fff8dbd1dd906030c85a">More...</a><br /></td></tr>
<tr class="separator:ac80f6d496557fff8dbd1dd906030c85a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa3ac2afb86a25ec1e1d8e4515133e9ad"><td class="memItemLeft" align="right" valign="top">SOAP_FMAC1 int SOAP_FMAC2&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#aa3ac2afb86a25ec1e1d8e4515133e9ad">soap_wsse_sign</a> (struct soap *soap, int alg, const void *key, int keylen)</td></tr>
<tr class="memdesc:aa3ac2afb86a25ec1e1d8e4515133e9ad"><td class="mdescLeft">&#160;</td><td class="mdescRight">Uses the wsse plugin to sign all wsu:Id attributed elements.  <a href="#aa3ac2afb86a25ec1e1d8e4515133e9ad">More...</a><br /></td></tr>
<tr class="separator:aa3ac2afb86a25ec1e1d8e4515133e9ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab653754f1a287ba06bd808cf89548c38"><td class="memItemLeft" align="right" valign="top">SOAP_FMAC1 int SOAP_FMAC2&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#ab653754f1a287ba06bd808cf89548c38">soap_wsse_sign_body</a> (struct soap *soap, int alg, const void *key, int keylen)</td></tr>
<tr class="memdesc:ab653754f1a287ba06bd808cf89548c38"><td class="mdescLeft">&#160;</td><td class="mdescRight">Uses the wsse plugin to sign all wsu:Id attributed elements, including the SOAP Body (by adding a wsu:Id="Body" attribute).  <a href="#ab653754f1a287ba06bd808cf89548c38">More...</a><br /></td></tr>
<tr class="separator:ab653754f1a287ba06bd808cf89548c38"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a246ebd371d9e92c74ec1e29bf92f3a"><td class="memItemLeft" align="right" valign="top">SOAP_FMAC1 int SOAP_FMAC2&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#a8a246ebd371d9e92c74ec1e29bf92f3a">soap_wsse_verify_init</a> (struct soap *soap)</td></tr>
<tr class="memdesc:a8a246ebd371d9e92c74ec1e29bf92f3a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Uses the wsse plugin to initiate the verification of the signature and SignedInfo Reference digests.  <a href="#a8a246ebd371d9e92c74ec1e29bf92f3a">More...</a><br /></td></tr>
<tr class="separator:a8a246ebd371d9e92c74ec1e29bf92f3a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7321b451910e1d3887b328f03de92f34"><td class="memItemLeft" align="right" valign="top">SOAP_FMAC1 int SOAP_FMAC2&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#a7321b451910e1d3887b328f03de92f34">soap_wsse_verify_auto</a> (struct soap *soap, int alg, const void *key, size_t keylen)</td></tr>
<tr class="memdesc:a7321b451910e1d3887b328f03de92f34"><td class="mdescLeft">&#160;</td><td class="mdescRight">Uses the wsse plugin to initiate the automatic verification of the signature and SignedInfo Reference digests.  <a href="#a7321b451910e1d3887b328f03de92f34">More...</a><br /></td></tr>
<tr class="separator:a7321b451910e1d3887b328f03de92f34"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a07db8f284ab2bb564248999fe02d0169"><td class="memItemLeft" align="right" valign="top">SOAP_FMAC1 int SOAP_FMAC2&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#a07db8f284ab2bb564248999fe02d0169">soap_wsse_verify_done</a> (struct soap *soap)</td></tr>
<tr class="memdesc:a07db8f284ab2bb564248999fe02d0169"><td class="mdescLeft">&#160;</td><td class="mdescRight">Terminates the automatic verification of signatures.  <a href="#a07db8f284ab2bb564248999fe02d0169">More...</a><br /></td></tr>
<tr class="separator:a07db8f284ab2bb564248999fe02d0169"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3fbe81de521579f026dd1ba8e81c59c1"><td class="memItemLeft" align="right" valign="top">SOAP_FMAC1 size_t SOAP_FMAC2&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#a3fbe81de521579f026dd1ba8e81c59c1">soap_wsse_verify_element</a> (struct soap *soap, const char *URI, const char *tag)</td></tr>
<tr class="memdesc:a3fbe81de521579f026dd1ba8e81c59c1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Post-checks the presence of signed element(s), returns the number of matching elements signed or zero when none found or if one or more matching elements are not signed. Does not verify the signature of these elements, which is done with <a class="el" href="wsseapi_8c.html#aba1ed2878f44b2c4efac24cd89ff30bf">soap_wsse_verify_auto</a>.  <a href="#a3fbe81de521579f026dd1ba8e81c59c1">More...</a><br /></td></tr>
<tr class="separator:a3fbe81de521579f026dd1ba8e81c59c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5ccbce0f1a4a8f103e921a918f932a20"><td class="memItemLeft" align="right" valign="top">SOAP_FMAC1 int SOAP_FMAC2&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#a5ccbce0f1a4a8f103e921a918f932a20">soap_wsse_verify_body</a> (struct soap *soap)</td></tr>
<tr class="memdesc:a5ccbce0f1a4a8f103e921a918f932a20"><td class="mdescLeft">&#160;</td><td class="mdescRight">Post-checks the presence of signed SOAP Body. Does not verify the signature of the Body, which is done with <a class="el" href="wsseapi_8c.html#aba1ed2878f44b2c4efac24cd89ff30bf">soap_wsse_verify_auto</a>.  <a href="#a5ccbce0f1a4a8f103e921a918f932a20">More...</a><br /></td></tr>
<tr class="separator:a5ccbce0f1a4a8f103e921a918f932a20"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9683d6e2780bf1d679e191ea18591cbc"><td class="memItemLeft" align="right" valign="top">SOAP_FMAC1 int SOAP_FMAC2&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#a9683d6e2780bf1d679e191ea18591cbc">soap_wsse_verify_with_signature</a> (struct soap *soap, <a class="el" href="ds_8h.html#a27725fd6615422a64169b1c0ad87b8fa">_ds__Signature</a> *signature)</td></tr>
<tr class="separator:a9683d6e2780bf1d679e191ea18591cbc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad6a0b722a052aaa7652cba5245f78b5f"><td class="memItemLeft" align="right" valign="top">SOAP_FMAC1 int SOAP_FMAC2&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#ad6a0b722a052aaa7652cba5245f78b5f">soap_wsse_set_security_token_handler</a> (struct soap *soap, const void *(*callback)(struct soap *, int *alg, const char *keyname, const unsigned char *keyid, int keyidlen, int *keylen))</td></tr>
<tr class="memdesc:ad6a0b722a052aaa7652cba5245f78b5f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the security token handler callback that is optionaly used to retrieve keys for signature verification and decryption.  <a href="#ad6a0b722a052aaa7652cba5245f78b5f">More...</a><br /></td></tr>
<tr class="separator:ad6a0b722a052aaa7652cba5245f78b5f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9582748dda80d0307e253f1a86c0c454"><td class="memItemLeft" align="right" valign="top">SOAP_FMAC1 int SOAP_FMAC2&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#a9582748dda80d0307e253f1a86c0c454">soap_wsse_set_wsu_id</a> (struct soap *soap, const char *tags)</td></tr>
<tr class="memdesc:a9582748dda80d0307e253f1a86c0c454"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the elements that are to be extended with wsu:Id attributes. The wsu:Id attribute values are set to the string value of the tag's QName by replacing colons with hyphens to produce an xsd:ID value.  <a href="#a9582748dda80d0307e253f1a86c0c454">More...</a><br /></td></tr>
<tr class="separator:a9582748dda80d0307e253f1a86c0c454"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a1670c6ee444704c8fb7ac612db37ff"><td class="memItemLeft" align="right" valign="top">SOAP_FMAC1 int SOAP_FMAC2&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#a7a1670c6ee444704c8fb7ac612db37ff">soap_wsse_set_InclusiveNamespaces</a> (struct soap *soap, const char *prefixlist)</td></tr>
<tr class="memdesc:a7a1670c6ee444704c8fb7ac612db37ff"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the C14N InclusiveNamespaces Prefix List property.  <a href="#a7a1670c6ee444704c8fb7ac612db37ff">More...</a><br /></td></tr>
<tr class="separator:a7a1670c6ee444704c8fb7ac612db37ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a16e38c1160a47ad2cb60d1b7d5dba777"><td class="memItemLeft" align="right" valign="top">SOAP_FMAC1 int SOAP_FMAC2&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#a16e38c1160a47ad2cb60d1b7d5dba777">soap_wsse_sign_only</a> (struct soap *soap, const char *tags)</td></tr>
<tr class="memdesc:a16e38c1160a47ad2cb60d1b7d5dba777"><td class="mdescLeft">&#160;</td><td class="mdescRight">Filters only the specified wsu:Id names for signing. Can be used with <a class="el" href="wsseapi_8c.html#a5aecbf5ab1b06aee118f149189a4008b" title="Sets the elements that are to be extended with wsu:Id attributes. The wsu:Id attribute values are set...">soap_wsse_set_wsu_id()</a> and if so should use the element tag names.  <a href="#a16e38c1160a47ad2cb60d1b7d5dba777">More...</a><br /></td></tr>
<tr class="separator:a16e38c1160a47ad2cb60d1b7d5dba777"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ba85a8b14587cff0865ebc3e5e9e340"><td class="memItemLeft" align="right" valign="top">SOAP_FMAC1 int SOAP_FMAC2&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#a1ba85a8b14587cff0865ebc3e5e9e340">soap_wsse_add_EncryptedKey</a> (struct soap *soap, int alg, const char *URI, X509 *cert, const char *subjectkeyid, const char *issuer, const char *serial)</td></tr>
<tr class="memdesc:a1ba85a8b14587cff0865ebc3e5e9e340"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds EncryptedKey header element and initiates the encryption of the SOAP Body.  <a href="#a1ba85a8b14587cff0865ebc3e5e9e340">More...</a><br /></td></tr>
<tr class="separator:a1ba85a8b14587cff0865ebc3e5e9e340"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adef816d148bd8b1ce1c5a3d023712779"><td class="memItemLeft" align="right" valign="top">SOAP_FMAC1 int SOAP_FMAC2&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#adef816d148bd8b1ce1c5a3d023712779">soap_wsse_add_EncryptedKey_encrypt_only</a> (struct soap *soap, int alg, const char *URI, X509 *cert, const char *subjectkeyid, const char *issuer, const char *serial, const char *tags)</td></tr>
<tr class="memdesc:adef816d148bd8b1ce1c5a3d023712779"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds EncryptedKey header element and initiates encryption of the given XML elements specified in the tags string. Should be used in combination with soap_wsse_set_wsu_id to set wsu:Id for given XML element tags.  <a href="#adef816d148bd8b1ce1c5a3d023712779">More...</a><br /></td></tr>
<tr class="separator:adef816d148bd8b1ce1c5a3d023712779"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afcfdd54e7c220fb90e11c75da3bbbe88"><td class="memItemLeft" align="right" valign="top">SOAP_FMAC1 int SOAP_FMAC2&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#afcfdd54e7c220fb90e11c75da3bbbe88">soap_wsse_verify_EncryptedKey</a> (struct soap *soap)</td></tr>
<tr class="memdesc:afcfdd54e7c220fb90e11c75da3bbbe88"><td class="mdescLeft">&#160;</td><td class="mdescRight">Verifies the EncryptedKey header information (certificate validity requires soap-&gt;cafile to be set). Retrieves the decryption key from the token handler callback to decrypt the decryption key.  <a href="#afcfdd54e7c220fb90e11c75da3bbbe88">More...</a><br /></td></tr>
<tr class="separator:afcfdd54e7c220fb90e11c75da3bbbe88"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad276cfcbd007515a6dce80c646e23ef5"><td class="memItemLeft" align="right" valign="top">SOAP_FMAC1 void SOAP_FMAC2&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#ad276cfcbd007515a6dce80c646e23ef5">soap_wsse_delete_EncryptedKey</a> (struct soap *soap)</td></tr>
<tr class="memdesc:ad276cfcbd007515a6dce80c646e23ef5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Deletes EncryptedKey header element.  <a href="#ad276cfcbd007515a6dce80c646e23ef5">More...</a><br /></td></tr>
<tr class="separator:ad276cfcbd007515a6dce80c646e23ef5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af597e92f133a6076523c46cb3dd879cd"><td class="memItemLeft" align="right" valign="top">SOAP_FMAC1 struct <a class="el" href="structxenc_____encrypted_key_type.html">xenc__EncryptedKeyType</a> *SOAP_FMAC2&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#af597e92f133a6076523c46cb3dd879cd">soap_wsse_EncryptedKey</a> (struct soap *soap)</td></tr>
<tr class="memdesc:af597e92f133a6076523c46cb3dd879cd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns EncryptedKey header element if present.  <a href="#af597e92f133a6076523c46cb3dd879cd">More...</a><br /></td></tr>
<tr class="separator:af597e92f133a6076523c46cb3dd879cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeec61121d56b2cf85e48997376c0b50a"><td class="memItemLeft" align="right" valign="top">SOAP_FMAC1 int SOAP_FMAC2&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#aeec61121d56b2cf85e48997376c0b50a">soap_wsse_add_EncryptedKey_DataReferenceURI</a> (struct soap *soap, const char *URI)</td></tr>
<tr class="memdesc:aeec61121d56b2cf85e48997376c0b50a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds a DataReference URI to the EncryptedKey header element.  <a href="#aeec61121d56b2cf85e48997376c0b50a">More...</a><br /></td></tr>
<tr class="separator:aeec61121d56b2cf85e48997376c0b50a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acbd56e9f4e7da00b1db51bca3e4f226b"><td class="memItemLeft" align="right" valign="top">SOAP_FMAC1 int SOAP_FMAC2&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#acbd56e9f4e7da00b1db51bca3e4f226b">soap_wsse_add_DataReferenceURI</a> (struct soap *soap, const char *URI)</td></tr>
<tr class="memdesc:acbd56e9f4e7da00b1db51bca3e4f226b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds a DataReference URI to the Security header element.  <a href="#acbd56e9f4e7da00b1db51bca3e4f226b">More...</a><br /></td></tr>
<tr class="separator:acbd56e9f4e7da00b1db51bca3e4f226b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac12c951db671e4e29810d0f0ae7f1b63"><td class="memItemLeft" align="right" valign="top">SOAP_FMAC1 int SOAP_FMAC2&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#ac12c951db671e4e29810d0f0ae7f1b63">soap_wsse_encrypt_body</a> (struct soap *soap, int alg, const void *key, int keylen)</td></tr>
<tr class="memdesc:ac12c951db671e4e29810d0f0ae7f1b63"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initiates the encryption of the SOAP Body. The algorithm should be SOAP_MEC_ENC_DES_CBC etc. for symmetric encryption. Use soap_wsse_add_EncryptedKey for public key encryption.  <a href="#ac12c951db671e4e29810d0f0ae7f1b63">More...</a><br /></td></tr>
<tr class="separator:ac12c951db671e4e29810d0f0ae7f1b63"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c417c369946561cbf72566349041805"><td class="memItemLeft" align="right" valign="top">SOAP_FMAC1 int SOAP_FMAC2&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#a3c417c369946561cbf72566349041805">soap_wsse_encrypt_only</a> (struct soap *soap, int alg, const void *key, int keylen, const char *tags)</td></tr>
<tr class="memdesc:a3c417c369946561cbf72566349041805"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initiates the encryption of XML elements specified in the tags string. Should be used in combination with soap_wsse_set_wsu_id to set wsu:Id for given XML element tags. The algorithm should be SOAP_MEC_ENC_DES_CBC etc. for symmetric encryption. Use soap_wsse_add_EncryptedKey_encrypt_only for public key encryption.  <a href="#a3c417c369946561cbf72566349041805">More...</a><br /></td></tr>
<tr class="separator:a3c417c369946561cbf72566349041805"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae783dfb65a01ad8d8e6e7ca1e5b3d805"><td class="memItemLeft" align="right" valign="top">SOAP_FMAC1 int SOAP_FMAC2&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#ae783dfb65a01ad8d8e6e7ca1e5b3d805">soap_wsse_encrypt</a> (struct soap *soap, int alg, const void *key, int keylen)</td></tr>
<tr class="memdesc:ae783dfb65a01ad8d8e6e7ca1e5b3d805"><td class="mdescLeft">&#160;</td><td class="mdescRight">Start encryption. This function is supposed to be used internally only. The algorithm should be SOAP_MEC_ENC_DES_CBC etc. for symmetric encryption. Use soap_wsse_add_EncryptedKey for public key. encryption.  <a href="#ae783dfb65a01ad8d8e6e7ca1e5b3d805">More...</a><br /></td></tr>
<tr class="separator:ae783dfb65a01ad8d8e6e7ca1e5b3d805"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a403569990cf3278a361552aecaf51ffc"><td class="memItemLeft" align="right" valign="top">SOAP_FMAC1 int SOAP_FMAC2&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#a403569990cf3278a361552aecaf51ffc">soap_wsse_decrypt_auto</a> (struct soap *soap, int alg, const void *key, int keylen)</td></tr>
<tr class="memdesc:a403569990cf3278a361552aecaf51ffc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Start automatic decryption when needed using the specified key. This function should be used just once. The algorithm should be SOAP_MEC_ENV_DEC_DES_CBC etc. for public key encryption/decryption and SOAP_MEC_DEC_DES_CBC etc. for symmetric shared secret keys.  <a href="#a403569990cf3278a361552aecaf51ffc">More...</a><br /></td></tr>
<tr class="separator:a403569990cf3278a361552aecaf51ffc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adcd40e09c2849899d0dafa03ba6e5b4c"><td class="memItemLeft" align="right" valign="top">SOAP_FMAC1 int SOAP_FMAC2&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#adcd40e09c2849899d0dafa03ba6e5b4c">soap_wsse_encrypt_begin</a> (struct soap *soap, const char *id, int alg, const char *URI, const char *keyname, const unsigned char *key, const char *type)</td></tr>
<tr class="memdesc:adcd40e09c2849899d0dafa03ba6e5b4c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Emit XML encryption tags and start encryption of the XML element content.  <a href="#adcd40e09c2849899d0dafa03ba6e5b4c">More...</a><br /></td></tr>
<tr class="separator:adcd40e09c2849899d0dafa03ba6e5b4c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a67d96a5fbfb37797a1223155957111cb"><td class="memItemLeft" align="right" valign="top">SOAP_FMAC1 int SOAP_FMAC2&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#a67d96a5fbfb37797a1223155957111cb">soap_wsse_encrypt_end</a> (struct soap *soap)</td></tr>
<tr class="memdesc:a67d96a5fbfb37797a1223155957111cb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Emit XML encryption end tags and stop encryption of the XML element content.  <a href="#a67d96a5fbfb37797a1223155957111cb">More...</a><br /></td></tr>
<tr class="separator:a67d96a5fbfb37797a1223155957111cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ac666e655fe29580b7f8bb393a76b59"><td class="memItemLeft" align="right" valign="top">SOAP_FMAC1 int SOAP_FMAC2&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#a0ac666e655fe29580b7f8bb393a76b59">soap_wsse_decrypt_begin</a> (struct soap *soap)</td></tr>
<tr class="memdesc:a0ac666e655fe29580b7f8bb393a76b59"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check for XML encryption tags and start decryption of the XML element content. If the KeyInfo element is present, the security_token_handler callback will be used to obtain a decryption key based on the key name.  <a href="#a0ac666e655fe29580b7f8bb393a76b59">More...</a><br /></td></tr>
<tr class="separator:a0ac666e655fe29580b7f8bb393a76b59"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1862170fdd18b54ab832347308d23019"><td class="memItemLeft" align="right" valign="top">SOAP_FMAC1 int SOAP_FMAC2&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#a1862170fdd18b54ab832347308d23019">soap_wsse_decrypt_end</a> (struct soap *soap)</td></tr>
<tr class="memdesc:a1862170fdd18b54ab832347308d23019"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check for XML encryption ending tags and stop decryption of the XML element content.  <a href="#a1862170fdd18b54ab832347308d23019">More...</a><br /></td></tr>
<tr class="separator:a1862170fdd18b54ab832347308d23019"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac36817d5b0e072bc93d52a06afb3a07e"><td class="memItemLeft" align="right" valign="top">SOAP_FMAC1 void SOAP_FMAC2&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#ac36817d5b0e072bc93d52a06afb3a07e">soap_default_xsd__anyType</a> (struct soap *, struct soap_dom_element *node)</td></tr>
<tr class="memdesc:ac36817d5b0e072bc93d52a06afb3a07e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes a DOM element node.  <a href="#ac36817d5b0e072bc93d52a06afb3a07e">More...</a><br /></td></tr>
<tr class="separator:ac36817d5b0e072bc93d52a06afb3a07e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac61d4b687c900aebf6a07de2f6d2165e"><td class="memItemLeft" align="right" valign="top">SOAP_FMAC1 int SOAP_FMAC2&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#ac61d4b687c900aebf6a07de2f6d2165e">soap_out_xsd__anyType</a> (struct soap *soap, const char *tag, int id, const struct soap_dom_element *node, const char *type)</td></tr>
<tr class="memdesc:ac61d4b687c900aebf6a07de2f6d2165e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Output a DOM element node.  <a href="#ac61d4b687c900aebf6a07de2f6d2165e">More...</a><br /></td></tr>
<tr class="separator:ac61d4b687c900aebf6a07de2f6d2165e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a00a1f5fb25fb6c993383517cbeee82fd"><td class="memItemLeft" align="right" valign="top">SOAP_FMAC1 struct soap_dom_element *SOAP_FMAC2&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#a00a1f5fb25fb6c993383517cbeee82fd">soap_in_xsd__anyType</a> (struct soap *soap, const char *tag, struct soap_dom_element *node, const char *type)</td></tr>
<tr class="memdesc:a00a1f5fb25fb6c993383517cbeee82fd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Input a DOM element node.  <a href="#a00a1f5fb25fb6c993383517cbeee82fd">More...</a><br /></td></tr>
<tr class="separator:a00a1f5fb25fb6c993383517cbeee82fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:af798c8221c5bdc2e45bd27a52e02c79f"><td class="memItemLeft" align="right" valign="top">const char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#af798c8221c5bdc2e45bd27a52e02c79f">soap_wsse_id</a> []</td></tr>
<tr class="separator:af798c8221c5bdc2e45bd27a52e02c79f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a38dfc9981f0859b1307c302d8497c08c"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#a38dfc9981f0859b1307c302d8497c08c">wsse_PasswordTextURI</a></td></tr>
<tr class="separator:a38dfc9981f0859b1307c302d8497c08c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a000638936fff26e30a3f256c495c1aa8"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#a000638936fff26e30a3f256c495c1aa8">wsse_PasswordDigestURI</a></td></tr>
<tr class="separator:a000638936fff26e30a3f256c495c1aa8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d0ae8f2dd1beaabdaa4884ea5dd41e4"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#a7d0ae8f2dd1beaabdaa4884ea5dd41e4">wsse_Base64BinaryURI</a></td></tr>
<tr class="separator:a7d0ae8f2dd1beaabdaa4884ea5dd41e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac07968b1c372e976758745ba7089c367"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#ac07968b1c372e976758745ba7089c367">wsse_X509v3URI</a></td></tr>
<tr class="separator:ac07968b1c372e976758745ba7089c367"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a88d310451ae729bbf0fdd149a9d7511c"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#a88d310451ae729bbf0fdd149a9d7511c">wsse_X509v3SubjectKeyIdentifierURI</a></td></tr>
<tr class="separator:a88d310451ae729bbf0fdd149a9d7511c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a71140ac907117b2bbf37f14939166a15"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#a71140ac907117b2bbf37f14939166a15">ds_sha1URI</a></td></tr>
<tr class="separator:a71140ac907117b2bbf37f14939166a15"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a99bf1005a6700b2e94cc400f799f4b93"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#a99bf1005a6700b2e94cc400f799f4b93">ds_sha256URI</a></td></tr>
<tr class="separator:a99bf1005a6700b2e94cc400f799f4b93"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a752690ab049714713ae0d240c0a11350"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#a752690ab049714713ae0d240c0a11350">ds_sha512URI</a></td></tr>
<tr class="separator:a752690ab049714713ae0d240c0a11350"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a352a6e78890296ade9e25de397f1096c"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#a352a6e78890296ade9e25de397f1096c">ds_hmac_sha1URI</a></td></tr>
<tr class="separator:a352a6e78890296ade9e25de397f1096c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab356216a1331e0ba33de2a62d1c8b5fb"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#ab356216a1331e0ba33de2a62d1c8b5fb">ds_hmac_sha256URI</a></td></tr>
<tr class="separator:ab356216a1331e0ba33de2a62d1c8b5fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a73b877c9a2879fcc6bfd311150beccbd"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#a73b877c9a2879fcc6bfd311150beccbd">ds_hmac_sha512URI</a></td></tr>
<tr class="separator:a73b877c9a2879fcc6bfd311150beccbd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1f62c1715e0f49fd54ffc263e45a12eb"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#a1f62c1715e0f49fd54ffc263e45a12eb">ds_dsa_sha1URI</a></td></tr>
<tr class="separator:a1f62c1715e0f49fd54ffc263e45a12eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad57129724eb01a743b6583afc522a131"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#ad57129724eb01a743b6583afc522a131">ds_rsa_sha1URI</a></td></tr>
<tr class="separator:ad57129724eb01a743b6583afc522a131"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a739fd4e4c86b17b58877a672bec79bc3"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#a739fd4e4c86b17b58877a672bec79bc3">ds_rsa_sha256URI</a></td></tr>
<tr class="separator:a739fd4e4c86b17b58877a672bec79bc3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6f17cf69547d2ead56934e89f10f3ba6"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#a6f17cf69547d2ead56934e89f10f3ba6">ds_rsa_sha512URI</a></td></tr>
<tr class="separator:a6f17cf69547d2ead56934e89f10f3ba6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a159d359ac83617f624b54d467db4e0b1"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#a159d359ac83617f624b54d467db4e0b1">xenc_3desURI</a></td></tr>
<tr class="separator:a159d359ac83617f624b54d467db4e0b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae62c2754ffb9473f23a83d03f9bd0066"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#ae62c2754ffb9473f23a83d03f9bd0066">xenc_aes128cbcURI</a></td></tr>
<tr class="separator:ae62c2754ffb9473f23a83d03f9bd0066"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1c03789019f942f38a52b7cf3e3261f9"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#a1c03789019f942f38a52b7cf3e3261f9">xenc_aes192cbcURI</a></td></tr>
<tr class="separator:a1c03789019f942f38a52b7cf3e3261f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a980c3cf82e86c8b0643c92ef785384f3"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#a980c3cf82e86c8b0643c92ef785384f3">xenc_aes256cbcURI</a></td></tr>
<tr class="separator:a980c3cf82e86c8b0643c92ef785384f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1093ef00c10baa0d9ac3c01858fc37ee"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#a1093ef00c10baa0d9ac3c01858fc37ee">xenc_aes512cbcURI</a></td></tr>
<tr class="separator:a1093ef00c10baa0d9ac3c01858fc37ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5251082fa5d641366794c3c2eb87a634"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#a5251082fa5d641366794c3c2eb87a634">xenc_aes128gcmURI</a></td></tr>
<tr class="separator:a5251082fa5d641366794c3c2eb87a634"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac5a138d550595ab0103f5ea0b899ceac"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#ac5a138d550595ab0103f5ea0b899ceac">xenc_aes192gcmURI</a></td></tr>
<tr class="separator:ac5a138d550595ab0103f5ea0b899ceac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7852df271f5783819a53fc3ee247ace2"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#a7852df271f5783819a53fc3ee247ace2">xenc_aes256gcmURI</a></td></tr>
<tr class="separator:a7852df271f5783819a53fc3ee247ace2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c3be5abe1067c475336bd84ff769ef1"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#a6c3be5abe1067c475336bd84ff769ef1">xenc_aes512gcmURI</a></td></tr>
<tr class="separator:a6c3be5abe1067c475336bd84ff769ef1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4fdac00892919c46ed53fa05b9cc0bdf"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#a4fdac00892919c46ed53fa05b9cc0bdf">xenc_elementURI</a></td></tr>
<tr class="separator:a4fdac00892919c46ed53fa05b9cc0bdf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abc58fc5b358c1f06737a623788dbfa0e"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#abc58fc5b358c1f06737a623788dbfa0e">xenc_contentURI</a></td></tr>
<tr class="separator:abc58fc5b358c1f06737a623788dbfa0e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c5bdcb80c33d0c3d35050091bd2cec5"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#a6c5bdcb80c33d0c3d35050091bd2cec5">xenc_rsa15URI</a></td></tr>
<tr class="separator:a6c5bdcb80c33d0c3d35050091bd2cec5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a43c42203ea88ef920b653d90307e6731"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#a43c42203ea88ef920b653d90307e6731">xenc_rsaesURI</a></td></tr>
<tr class="separator:a43c42203ea88ef920b653d90307e6731"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad7aea4af6b24389f66019e8984d4b05c"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#ad7aea4af6b24389f66019e8984d4b05c">ds_URI</a></td></tr>
<tr class="separator:ad7aea4af6b24389f66019e8984d4b05c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4089697df0f14ecf44cf0fb6098f4f78"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#a4089697df0f14ecf44cf0fb6098f4f78">c14n_URI</a></td></tr>
<tr class="separator:a4089697df0f14ecf44cf0fb6098f4f78"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adb66cffe8d95c5d511987189173a993c"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8h.html#adb66cffe8d95c5d511987189173a993c">wsu_URI</a></td></tr>
<tr class="separator:adb66cffe8d95c5d511987189173a993c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="a263bd9819133fc1daccc34458c991ff9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SOAP_WSSE_ID&#160;&#160;&#160;&quot;SOAP-WSSE/1.5&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>plugin identification for plugin registry </p>

</div>
</div>
<a class="anchor" id="ae6f973cd88cca2187640822dc86fcd9e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SOAP_WSSE_IGNORE_EXTRA_REFS&#160;&#160;&#160;(0x1000)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>to ignore extra/external SignedInfo/Reference/ </p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ac36817d5b0e072bc93d52a06afb3a07e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void soap_default_xsd__anyType </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct soap_dom_element *&#160;</td>
          <td class="paramname"><em>node</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initializes a DOM element node. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramname">node</td><td>pointer to DOM element node. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a00a1f5fb25fb6c993383517cbeee82fd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct soap_dom_element * soap_in_xsd__anyType </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>tag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct soap_dom_element *&#160;</td>
          <td class="paramname"><em>node</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Input a DOM element node. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">tag</td><td>XML element tag name to verify or NULL </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">node</td><td>pointer to DOM element node to parse </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">type</td><td>xsi:type to verify or NULL </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ac61d4b687c900aebf6a07de2f6d2165e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int soap_out_xsd__anyType </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>tag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct soap_dom_element *&#160;</td>
          <td class="paramname"><em>node</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Output a DOM element node. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">tag</td><td>XML element tag name </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">id</td><td>integer ref id value or zero if none </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">node</td><td>pointer to DOM element node to send </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">type</td><td>xsi:type or NULL </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a0e8a5373312b996b931fd521cd42fdaf"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int soap_pmd5 </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>hmac_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>hmac_key_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>secret</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>secretlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>pmd5</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>pmd5len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes PMD5(hmac_key[0..hmac_key_len-1], secret[0..secretlen-1], pmd5[0..pmd5len-1]). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hmac_key</td><td>HMAC key (client secret) in raw bytes </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hmac_key_len</td><td>HMAC key length </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">secret</td><td>seed (server secret) raw bytes </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">secretlen</td><td>number of bytes </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">pmd5</td><td>points to pmd5 raw bytes to fill with result </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pmd5len</td><td>number of bytes to fill pmd5 </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>SOAP_OK or SOAP_EOM</dd></dl>
<p>To compute PMD5 with base64 input and output a base64 encoded pmd5[0..pmd5len-1]: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;int pmd5len = 32; // or greater</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;int n, m;</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;const char *client_secret = soap_base642s(soap, client_secret_base64, NULL, 0, &amp;n);</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;const char *server_secret = soap_base642s(soap, server_secret_base64, NULL, 0, &amp;m);</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;char pmd5[pmd5len];</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;char *pmd5_base64;</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;if (soap_pmd5(soap, client_secret, n, server_secret, m, pmd5, pmd5len))</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;  .. error // insufficient memory</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;pmd5_base64 = soap_s2base64(soap, (unsigned char*)pmd5, NULL, pmd5len);</div></div><!-- fragment --> 
</div>
</div>
<a class="anchor" id="a1992e3ad46bc687b95f0917e86c5b9a5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int soap_psha1 </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>hmac_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>hmac_key_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>secret</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>secretlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>psha1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>psha1len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes PSHA1(hmac_key[0..hmac_key_len-1], secret[0..secretlen-1], psha1[0..psha1len-1]). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hmac_key</td><td>HMAC key (client secret) in raw bytes </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hmac_key_len</td><td>HMAC key length </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">secret</td><td>seed (server secret) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">secretlen</td><td>number of bytes </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">psha1</td><td>points to psha1 raw bytes to fill with result </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">psha1len</td><td>number of bytes to fill psha1 </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>SOAP_OK or SOAP_EOM</dd></dl>
<p>To compute PSHA1 with base64 input and output a base64 encoded psha1[0..psha1len-1]: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;int psha1len = 32; // or greater</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;int n, m;</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;const char *client_secret = soap_base642s(soap, client_secret_base64, NULL, 0, &amp;n);</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;const char *server_secret = soap_base642s(soap, server_secret_base64, NULL, 0, &amp;m);</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;char psha1[psha1len];</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;char *psha1_base64;</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;if (soap_psha1(soap, client_secret, n, server_secret, m, psha1, psha1len))</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;  .. error // insufficient memory</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;psha1_base64 = soap_s2base64(soap, (unsigned char*)psha1, NULL, psha1len);</div></div><!-- fragment --> 
</div>
</div>
<a class="anchor" id="ac80f6d496557fff8dbd1dd906030c85a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int soap_psha256 </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>hmac_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>hmac_key_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>secret</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>secretlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>psha256</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>psha256len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes PSHA256(hmac_key[0..hmac_key_len-1], secret[0..secretlen-1], psha256[0..psha256len-1]). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hmac_key</td><td>HMAC key (client secret) in raw bytes </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hmac_key_len</td><td>HMAC key length </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">secret</td><td>seed (server secret) raw bytes </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">secretlen</td><td>number of bytes </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">psha256</td><td>points to psha256 raw bytes to fill with result </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">psha256len</td><td>number of bytes to fill psha256 </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>SOAP_OK or SOAP_EOM</dd></dl>
<p>To compute PSHA256 with base64 input and output a base64 encoded psha256[0..psha256len-1]: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;int psha256len = 32; // or greater</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;int n, m;</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;const char *client_secret = soap_base642s(soap, client_secret_base64, NULL, 0, &amp;n);</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;const char *server_secret = soap_base642s(soap, server_secret_base64, NULL, 0, &amp;m);</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;char psha256[psha256len];</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;char *psha256_base64;</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;if (soap_psha256(soap, client_secret, n, server_secret, m, psha256, psha256len))</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;  .. error // insufficient memory</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;psha256_base64 = soap_s2base64(soap, (unsigned char*)psha256, NULL, psha256len);</div></div><!-- fragment --> 
</div>
</div>
<a class="anchor" id="af15bedb61bffb589683354bc37d20c3a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int soap_wsse </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct soap_plugin *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>arg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Plugin registry function, used with soap_register_plugin. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">p</td><td>plugin created in registry </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">arg</td><td>passed from soap_register_plugin_arg is an optional security token handler callback </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>SOAP_OK </dd></dl>

</div>
</div>
<a class="anchor" id="a272ece3d02d7fbb5309cda9d1b252822"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int soap_wsse_add_BinarySecurityToken </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>valueType</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Adds BinarySecurityToken element. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">id</td><td>string for signature referencing or NULL </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">valueType</td><td>string </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">data</td><td>points to binary token data </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">size</td><td>is length of binary token </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>SOAP_OK </dd></dl>

</div>
</div>
<a class="anchor" id="ad88d8317bcbbcda4cdc8d1bcfb2e0f18"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int soap_wsse_add_BinarySecurityTokenPEM </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>filename</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Adds BinarySecurityToken element from a PEM file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">id</td><td>string for signature reference </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">filename</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>SOAP_OK or SOAP_FAULT with wsse__InvalidSecurity fault when file cannot be read or does not contain a valid certificate</dd></dl>
<p>This function uses PEM_read_X509 from the the OpenSSL library to read a certificate from a PEM formatted file. </p>

</div>
</div>
<a class="anchor" id="a53075fb3cec4ec4e70fb11850fecb401"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int soap_wsse_add_BinarySecurityTokenX509 </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">X509 *&#160;</td>
          <td class="paramname"><em>cert</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Adds BinarySecurityToken element with X509 certificate. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">id</td><td>string for signature reference </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cert</td><td>points to the X509 certificate </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>SOAP_OK or SOAP_EOM</dd></dl>
<p>This function uses i2d_X509 from the the OpenSSL library to convert an X509 object to binary DER format. </p>

</div>
</div>
<a class="anchor" id="acbd56e9f4e7da00b1db51bca3e4f226b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int soap_wsse_add_DataReferenceURI </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>URI</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Adds a DataReference URI to the Security header element. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">URI</td><td>value of the URI ID </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>SOAP_OK or error code </dd></dl>

</div>
</div>
<a class="anchor" id="a0569043138de574a8f61f45b608971ad"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int soap_wsse_add_EncryptedData_KeyInfo_KeyName </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>keyname</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Adds EncryptedData/ds:KeyInfo/Keyname elements. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">keyname</td><td>name of the key </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>SOAP_OK or error code</dd></dl>
<p>This function adds the name of the key to each EncryptedData element to identify the shared secret key used for encryption. </p>

</div>
</div>
<a class="anchor" id="a1ba85a8b14587cff0865ebc3e5e9e340"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int soap_wsse_add_EncryptedKey </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>alg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>URI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">X509 *&#160;</td>
          <td class="paramname"><em>cert</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>subjectkeyid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>issuer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>serial</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Adds EncryptedKey header element and initiates the encryption of the SOAP Body. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">alg</td><td>algorithm to use, SOAP_MEC_ENV_ENC_DES_CBC etc. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">URI</td><td>a unique identifier for the key, required for interoperability </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cert</td><td>the X509 certificate with public key or NULL </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">subjectkeyid</td><td>string identification of the subject which when set to non-NULL is used instead of embedding the public key in the message </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">issuer</td><td>string to include SecurityTokenReference/X509Data </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">serial</td><td>string to include SecurityTokenReference/X509Data </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>SOAP_OK or error code</dd></dl>
<p>This function adds the encrypted key or subject key ID to the WS-Security header and initiates encryption of the SOAP Body. An X509 certificate may be provided, or the subjectkeyid, or the issuer and serial number. The certificate is embedded in the WS-Security EncryptedKey header. If the subjectkeyid string is non-NULL the subject key ID is used in the EncryptedKey header instead of the X509 certificate content. </p>

</div>
</div>
<a class="anchor" id="aeec61121d56b2cf85e48997376c0b50a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int soap_wsse_add_EncryptedKey_DataReferenceURI </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>URI</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Adds a DataReference URI to the EncryptedKey header element. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">URI</td><td>value of the URI ID </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>SOAP_OK or error code </dd></dl>

</div>
</div>
<a class="anchor" id="adef816d148bd8b1ce1c5a3d023712779"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int soap_wsse_add_EncryptedKey_encrypt_only </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>alg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>URI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">X509 *&#160;</td>
          <td class="paramname"><em>cert</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>subjectkeyid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>issuer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>serial</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>tags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Adds EncryptedKey header element and initiates encryption of the given XML elements specified in the tags string. Should be used in combination with soap_wsse_set_wsu_id to set wsu:Id for given XML element tags. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">alg</td><td>algorithm to use, SOAP_MEC_ENV_ENC_DES_CBC etc. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">URI</td><td>a unique identifier for the key, required for interoperability </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cert</td><td>the X509 certificate with public key or NULL </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">subjectkeyid</td><td>string identification of the subject which when set to non-NULL is used instead of embedding the public key in the message </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">issuer</td><td>string to include SecurityTokenReference/X509Data </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">serial</td><td>string to include SecurityTokenReference/X509Data </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tags</td><td>space-separated string of element tag names to encrypt </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="structxenc_____encrypted_key_type.html" title="&quot;http://www.w3.org/2001/04/xmlenc#&quot;:EncryptedKeyType is a complexType with complexContent extension o...">xenc__EncryptedKeyType</a> object</dd></dl>
<p>This function adds the encrypted key or subject key ID to the WS-Security header and initiates encryption of the SOAP Body. An X509 certificate may be provided, or the subjectkeyid, or the issuer and serial number. The certificate is embedded in the WS-Security EncryptedKey header. If the subjectkeyid string is non-NULL the subject key ID is used in the EncryptedKey header instead of the X509 certificate content. Only the XML elements given in the 'tags' string as wsu:Id attributed elements are encrypted.</p>
<dl class="section warning"><dt>Warning</dt><dd>Use <a class="el" href="wsseapi_8c.html#a4be2293dd1017747cde56a6246c0e17a">soap_wsse_add_EncryptedKey_encrypt_only</a> only in combination with <a class="el" href="wsseapi_8c.html#a5aecbf5ab1b06aee118f149189a4008b">soap_wsse_set_wsu_id</a> with the tag names of the elements to be encrypted. OTHERWISE THE GIVEN XML ELEMENTS ARE NOT ENCRYPTED AND WILL BE SENT IN THE CLEAR.</dd>
<dd>
The elements identified with <a class="el" href="wsseapi_8c.html#a5aecbf5ab1b06aee118f149189a4008b">soap_wsse_set_wsu_id</a> to encrypt MUST occur EXACTLY ONCE in the SOAP Body.</dd>
<dd>
Encryption/decryption of elements with simple content (CDATA content) IS NOT SUPPORTED. This means that elements you want to encrypt with this function must have complex content. That is, only encrypt elements with sub elements or encrypt the entire SOAP Body. </dd></dl>

</div>
</div>
<a class="anchor" id="a66938fb25c79caddb31d4e6c8ff443d2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structds_____key_info_type.html">ds__KeyInfoType</a> * soap_wsse_add_KeyInfo </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Adds KeyInfo element. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">soap</td><td>context </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>ds__KeyInfo object </dd></dl>

</div>
</div>
<a class="anchor" id="a25240140007f1776479e81dd43457f40"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int soap_wsse_add_KeyInfo_KeyName </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>name</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Adds KeyName element. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">name</td><td>string of the KeyName </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>SOAP_OK</dd></dl>
<dl class="section note"><dt>Note</dt><dd>The recommended method to add Key information is to utilize KeyIdentifier instead of KeyName. A KeyName is useful mainly for internal use. </dd></dl>

</div>
</div>
<a class="anchor" id="a8fcf5947eb011d73b6a6b1308123a536"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int soap_wsse_add_KeyInfo_SecurityTokenReferenceEmbedded </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>valueType</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Adds KeyInfo element with Embedded SecurityTokenReference. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">id</td><td>string for signature reference </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">valueType</td><td>string </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>SOAP_OK</dd></dl>
<dl class="section note"><dt>Note</dt><dd>This function does not add embedded tokens automatically. See code for comments. </dd></dl>

</div>
</div>
<a class="anchor" id="a83ad7822556d691020209fa12d1c79a7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int soap_wsse_add_KeyInfo_SecurityTokenReferenceKeyIdentifier </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>valueType</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Adds KeyInfo element with SecurityTokenReference/KeyIdentifier binary data. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">id</td><td>string for signature reference </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">valueType</td><td>string </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">data</td><td>binary data </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">size</td><td>of binary data </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>SOAP_OK </dd></dl>

</div>
</div>
<a class="anchor" id="aa1557c59801a0c3e4a77c1cb56cc2d9e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int soap_wsse_add_KeyInfo_SecurityTokenReferenceURI </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>URI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>valueType</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Adds KeyInfo element with SecurityTokenReference URI. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">URI</td><td>string referencing a security token </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">valueType</td><td>string or NULL </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>SOAP_OK </dd></dl>

</div>
</div>
<a class="anchor" id="a72df80abd1d36cea516feda3a84672cf"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int soap_wsse_add_KeyInfo_SecurityTokenReferenceX509 </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>URI</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Adds KeyInfo element with SecurityTokenReference URI to an X509 cert. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">URI</td><td>string referencing an X509 certificate </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>SOAP_OK </dd></dl>

</div>
</div>
<a class="anchor" id="abe67a8a00c79480f83078c04ab2d1fc3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int soap_wsse_add_KeyInfo_X509Certificate </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">X509 *&#160;</td>
          <td class="paramname"><em>cert</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Adds KeyInfo/X509Data/X509Certificate. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cert</td><td>X509 certificate </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>SOAP_OK or error code </dd></dl>

</div>
</div>
<a class="anchor" id="acdc56c76c1a39c3e6191580d491f9b8e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct__wsse_____security.html">_wsse__Security</a> * soap_wsse_add_Security </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Adds Security header element. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">soap</td><td>context </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="struct__wsse_____security.html" title="This element defines the wsse:Security SOAP header element per Section 4. Imported element _wsse__Sec...">_wsse__Security</a> object </dd></dl>

</div>
</div>
<a class="anchor" id="a16b318c7c4e19d55a07503d72b49e0d7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct__wsse_____security.html">_wsse__Security</a> * soap_wsse_add_Security_actor </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>actor</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Adds Security header element with actor or role attribute. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramname">actor</td><td>string </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="struct__wsse_____security.html" title="This element defines the wsse:Security SOAP header element per Section 4. Imported element _wsse__Sec...">_wsse__Security</a> object </dd></dl>

</div>
</div>
<a class="anchor" id="a4941ccab15e473e979ff4b3a926c04bb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int soap_wsse_add_SecurityContextToken </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>identifier</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Adds wsc:SecurityContextToken/Identifier and SecurityTokenReference to it. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">id</td><td>string for signature reference (required) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">identifier</td><td>wsc:Identifier value (required) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>SOAP_OK or error code </dd></dl>

</div>
</div>
<a class="anchor" id="a7bef911f7276f37c393172d9bf875ffd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structds_____signature_type.html">ds__SignatureType</a> * soap_wsse_add_Signature </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Adds Signature header element. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">soap</td><td>context </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="structds_____signature_type.html">ds__SignatureType</a> object </dd></dl>

</div>
</div>
<a class="anchor" id="a7399c40e0019bc1ae797fccf92f81fc7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int soap_wsse_add_SignatureValue </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>alg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>keylen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Adds SignedInfo/SignatureMethod element, signs the SignedInfo element, and adds the resulting SignatureValue element. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">alg</td><td>is SOAP_SMD_HMAC_SHA1/224/256/384/512, SOAP_SMD_SIGN_DSA_SHA1/256, SOAP_SMD_SIGN_RSA_SHA1/224/256/384/512, or SOAP_SMD_SIGN_ECDSA_SHA1/224/256/384/512 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">key</td><td>to use to sign (HMAC or DSA/RSA/ECDSA EVP_PKEY) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">keylen</td><td>length of HMAC key </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>SOAP_OK, SOAP_EOM, or fault</dd></dl>
<p>To sign the SignedInfo element with this function, populate SignedInfo with Reference elements first using soap_wsse_add_SignedInfo_Reference. The SignedInfo element must not be modified after signing.</p>
<p>The SOAP_XML_INDENT and SOAP_XML_CANONICAL flags are used to serialize the SignedInfo to compute the signature. </p>

</div>
</div>
<a class="anchor" id="a0a0471df1dd7192cd6541c9eb5d58512"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structds_____signed_info_type.html">ds__SignedInfoType</a> * soap_wsse_add_SignedInfo </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Adds SignedInfo element. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">soap</td><td>context </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="structds_____signed_info_type.html" title="&quot;http://www.w3.org/2000/09/xmldsig#&quot;:SignedInfoType is a complexType. ">ds__SignedInfoType</a> object </dd></dl>

</div>
</div>
<a class="anchor" id="a2f987fb35c08ea173e81fdf27e599b87"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int soap_wsse_add_SignedInfo_Reference </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>URI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>level</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>transform</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>prefixlist</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>alg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>HA</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Adds SignedInfo element with Reference URI, transform algorithm used, and digest value. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">URI</td><td>reference </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">level</td><td>XML depth of element signed </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">transform</td><td>string should be exc_c14n_URI for exc-c14n, or c14n_URI or NULL for default (no canonicalization) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">prefixlist</td><td>used by the exc-c14n transform or NULL </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">alg</td><td>is the digest algorithm used </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">HA</td><td>is the digest in binary form </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>SOAP_OK or SOAP_EOM when references exceed SOAP_WSSE_MAX_REF</dd></dl>
<p>This function can be called to add more references to the wsse:SignedInfo element. A maximum number of SOAP_WSSE_MAX_REF references can be added. The digest method is always SHA1.</p>
<dl class="section note"><dt>Note</dt><dd>XPath transforms cannot be specified in this release. </dd></dl>

</div>
</div>
<a class="anchor" id="a398f98d62dfba91d04cff19230fb6722"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int soap_wsse_add_SignedInfo_SignatureMethod </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>method</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>canonical</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Adds SignedInfo element with SignatureMethod. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">method</td><td>is the URI of the signature algorithm (e.g. ds_rsa_sha1) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">canonical</td><td>flag indicating that SignedInfo is signed in exc-c14n form or in c14n when soap-&gt;c14ninclude == "*" (i.e. all prefixes are inclusive) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>SOAP_OK </dd></dl>

</div>
</div>
<a class="anchor" id="a71fe27aee76db1d0a635afe106d8b109"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int soap_wsse_add_Timestamp </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">time_t&#160;</td>
          <td class="paramname"><em>lifetime</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Adds Timestamp element with optional expiration date+time (lifetime). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">id</td><td>for signature referencing or NULL </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lifetime</td><td>expressed in time_t units, or 0 for no expiration </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>SOAP_OK </dd></dl>

</div>
</div>
<a class="anchor" id="ac9fe59008bdf12d7a007ac48e6ebb613"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int soap_wsse_add_UsernameTokenDigest </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>username</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>password</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Adds UsernameToken element for digest authentication. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">id</td><td>string for signature referencing or NULL </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">username</td><td>string </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">password</td><td>string </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>SOAP_OK</dd></dl>
<p>Computes SHA1 digest of the time stamp, a nonce, and the password. The digest provides the authentication credentials. Passwords are NOT sent in the clear.</p>
<dl class="section note"><dt>Note</dt><dd>This release supports the use of at most one UsernameToken in the header. </dd></dl>

</div>
</div>
<a class="anchor" id="a7204edbdd78caf5f1e26f0244e0214ee"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int soap_wsse_add_UsernameTokenDigest_at </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>username</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>password</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">time_t&#160;</td>
          <td class="paramname"><em>when</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Adds UsernameToken element for digest authentication. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">id</td><td>string for signature referencing or NULL </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">username</td><td>string </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">password</td><td>string </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">when</td><td>the time stamp to use for the digest hash </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>SOAP_OK</dd></dl>
<p>Computes SHA1 digest of the time stamp, a nonce, and the password. The digest provides the authentication credentials. Passwords are NOT sent in the clear.</p>
<dl class="section note"><dt>Note</dt><dd>This release supports the use of at most one UsernameToken in the header. </dd></dl>

</div>
</div>
<a class="anchor" id="a37f32e51bceabf2e2823516a1737548f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int soap_wsse_add_UsernameTokenText </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>username</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>password</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Adds UsernameToken element with optional clear-text password. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">id</td><td>string for signature referencing or NULL </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">username</td><td>string </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">password</td><td>string or NULL to omit the password </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>SOAP_OK</dd></dl>
<p>Passwords are sent in the clear, so transport-level encryption is required.</p>
<dl class="section note"><dt>Note</dt><dd>This release supports the use of at most one UsernameToken in the header. </dd></dl>

</div>
</div>
<a class="anchor" id="aaff2b8d3e40827341ac0382cd501c04b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct__wsse_____binary_security_token.html">_wsse__BinarySecurityToken</a> * soap_wsse_BinarySecurityToken </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns BinarySecurityToken element if present. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">id</td><td>string of token to get or NULL to get the first </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="struct__wsse_____binary_security_token.html" title="This element defines the wsse:BinarySecurityToken element per Section 4.2. Imported element _wsse__Bi...">_wsse__BinarySecurityToken</a> object or NULL </dd></dl>

</div>
</div>
<a class="anchor" id="a403569990cf3278a361552aecaf51ffc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int soap_wsse_decrypt_auto </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>alg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>keylen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Start automatic decryption when needed using the specified key. This function should be used just once. The algorithm should be SOAP_MEC_ENV_DEC_DES_CBC etc. for public key encryption/decryption and SOAP_MEC_DEC_DES_CBC etc. for symmetric shared secret keys. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">alg</td><td>the decryption algorithm, </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">key</td><td>a persistent decryption key for the algorithm, a private RSA key or a shared symmetric secret key </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">keylen</td><td>use 0 for public-key encryption/decryption or the shared secret decryption key length, 20 bytes for a DES CBC 160-bit key </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>SOAP_OK or error code</dd></dl>
<p>This function can be called once before multiple messages are received with WS-Security encrypted content, where only one key is used for encryption (public key or shared secret key). The default decryption key is set. If multiple decryption keys should be used, do NOT use this function but set the security_token_handler callback of the wsse plugin. See <a class="el" href="wsse.html#wsse_9_2">Decrypting Message Parts</a>. Use a NULL key to remove the default decryption key. </p>

</div>
</div>
<a class="anchor" id="a0ac666e655fe29580b7f8bb393a76b59"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int soap_wsse_decrypt_begin </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check for XML encryption tags and start decryption of the XML element content. If the KeyInfo element is present, the security_token_handler callback will be used to obtain a decryption key based on the key name. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">soap</td><td>context </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>SOAP_OK or error code </dd></dl>

</div>
</div>
<a class="anchor" id="a1862170fdd18b54ab832347308d23019"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int soap_wsse_decrypt_end </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check for XML encryption ending tags and stop decryption of the XML element content. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">soap</td><td>context </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>SOAP_OK or error code </dd></dl>

</div>
</div>
<a class="anchor" id="ad276cfcbd007515a6dce80c646e23ef5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void soap_wsse_delete_EncryptedKey </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Deletes EncryptedKey header element. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">soap</td><td>context </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ac06c7021592b2aaca50f73e0de9dec7c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void soap_wsse_delete_Security </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Deletes Security header element. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">soap</td><td>context </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ad817f20012b39724f7351909b0b79df2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void soap_wsse_delete_Signature </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Deletes Signature header element. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">soap</td><td>context </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ae783dfb65a01ad8d8e6e7ca1e5b3d805"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int soap_wsse_encrypt </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>alg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>keylen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Start encryption. This function is supposed to be used internally only. The algorithm should be SOAP_MEC_ENC_DES_CBC etc. for symmetric encryption. Use soap_wsse_add_EncryptedKey for public key. encryption. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">alg</td><td>the encryption algorithm, should be SOAP_MEC_ENC_DES_CBC etc. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">key</td><td>a certificate with public key for encryption, a DES CBC 160-bit key or AES key </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">keylen</td><td>the symmetric encryption key length, 20 bytes for a DES CBC 160-bit key </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>SOAP_OK or error code </dd></dl>

</div>
</div>
<a class="anchor" id="adcd40e09c2849899d0dafa03ba6e5b4c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int soap_wsse_encrypt_begin </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>alg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>URI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>keyname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Emit XML encryption tags and start encryption of the XML element content. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">id</td><td>string for the EncryptedData element Id attribute </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">alg</td><td>algorithm used, or SOAP_MEC_NONE to ignore </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">URI</td><td>string for the encrypted element wsu:Id attribute </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">keyname</td><td>optional subject key name </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">key</td><td>optional DES/AES key for encryption (to override the current key) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">type</td><td>of encryption, either xenc_elementURI ("http://www.w3.org/2001/04/xmlenc#Element") or xenc_contentURI ("http://www.w3.org/2001/04/xmlenc#Content") </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>SOAP_OK or error code </dd></dl>

</div>
</div>
<a class="anchor" id="ac12c951db671e4e29810d0f0ae7f1b63"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int soap_wsse_encrypt_body </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>alg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>keylen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initiates the encryption of the SOAP Body. The algorithm should be SOAP_MEC_ENC_DES_CBC etc. for symmetric encryption. Use soap_wsse_add_EncryptedKey for public key encryption. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">alg</td><td>the encryption algorithm, should be SOAP_MEC_ENC_DES_CBC etc. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">key</td><td>a certificate with public key for encryption, a DES CBC 160-bit key or AES key </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">keylen</td><td>the symmetric encryption key length, 20 bytes for a DES CBC 160-bit key or larger for AES key </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>SOAP_OK or error code</dd></dl>
<p>This function initiates the encryption of the SOAP Body using an RSA public key or a symmetric shared secret key. No WS-Security EncryptedKey header will be set. Use soap_wsse_add_EncryptedKey instead for public key encryption. </p>

</div>
</div>
<a class="anchor" id="a67d96a5fbfb37797a1223155957111cb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int soap_wsse_encrypt_end </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Emit XML encryption end tags and stop encryption of the XML element content. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">soap</td><td>context </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>SOAP_OK or error code </dd></dl>

</div>
</div>
<a class="anchor" id="a3c417c369946561cbf72566349041805"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int soap_wsse_encrypt_only </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>alg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>keylen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>tags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initiates the encryption of XML elements specified in the tags string. Should be used in combination with soap_wsse_set_wsu_id to set wsu:Id for given XML element tags. The algorithm should be SOAP_MEC_ENC_DES_CBC etc. for symmetric encryption. Use soap_wsse_add_EncryptedKey_encrypt_only for public key encryption. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">alg</td><td>the encryption algorithm, should be SOAP_MEC_ENC_DES_CBC etc. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">key</td><td>a certificate with public key for encryption, a DES CBC 160-bit key or AES key </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">keylen</td><td>the symmetric encryption key length, 20 bytes for a DES CBC 160-bit key </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tags</td><td>string of space-separated qualified and unqualified tag names </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>SOAP_OK or error code</dd></dl>
<p>This function initiates the encryption using an RSA public key or a symmetric shared secret key. No WS-Security EncryptedKey header will be set. Use soap_wsse_add_EncryptedKey instead for public key encryption.</p>
<dl class="section warning"><dt>Warning</dt><dd>Use <a class="el" href="wsseapi_8c.html#a4be2293dd1017747cde56a6246c0e17a">soap_wsse_add_EncryptedKey_encrypt_only</a> only in combination with <a class="el" href="wsseapi_8c.html#a5aecbf5ab1b06aee118f149189a4008b">soap_wsse_set_wsu_id</a> with the tag names of the elements to be encrypted. OTHERWISE THE GIVEN XML ELEMENTS ARE NOT ENCRYPTED AND WILL BE SENT IN THE CLEAR.</dd>
<dd>
The elements identified with <a class="el" href="wsseapi_8c.html#a5aecbf5ab1b06aee118f149189a4008b">soap_wsse_set_wsu_id</a> to encrypt MUST occur EXACTLY ONCE in the SOAP Body.</dd>
<dd>
Encryption/decryption of elements with simple content (CDATA content) IS NOT SUPPORTED. This means that elements you want to encrypt with this function must have complex content. That is, only encrypt elements with sub elements or encrypt the entire SOAP Body. </dd></dl>

</div>
</div>
<a class="anchor" id="af597e92f133a6076523c46cb3dd879cd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structxenc_____encrypted_key_type.html">xenc__EncryptedKeyType</a> * soap_wsse_EncryptedKey </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns EncryptedKey header element if present. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">soap</td><td>context </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="structxenc_____encrypted_key_type.html" title="&quot;http://www.w3.org/2001/04/xmlenc#&quot;:EncryptedKeyType is a complexType with complexContent extension o...">xenc__EncryptedKeyType</a> object or NULL </dd></dl>

</div>
</div>
<a class="anchor" id="af333975761fe6c00031a223a2036311b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int soap_wsse_fault </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="wsse_8h.html#aaade5f4816d66546a0817dade206f50f">wsse__FaultcodeEnum</a>&#160;</td>
          <td class="paramname"><em>fault</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>detail</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets SOAP Fault (sub)code for server response. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fault</td><td>is one of wsse:FaultcodeEnum </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">detail</td><td>string with optional text message </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>SOAP_FAULT </dd></dl>

</div>
</div>
<a class="anchor" id="a7496da1dd76aa06e6657365b5c7dd76d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int soap_wsse_get_BinarySecurityToken </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>valueType</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char **&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get wsse:BinarySecurityToken element token data in binary form. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">id</td><td>string of token to get or NULL to get the first </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">valueType</td><td>string </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">data</td><td>points to binary token data </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">size</td><td>is length of binary token </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>SOAP_OK or SOAP_FAULT with wsse:SecurityTokenUnavailable fault </dd></dl>

</div>
</div>
<a class="anchor" id="a2ec22f47b0c66b62ef3c96d8f7b31436"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">X509 * soap_wsse_get_BinarySecurityTokenX509 </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get X509 wsse:BinarySecurityToken certificate and verify its content. This call must be followed by an X509_free to deallocate the X509 certificate data. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">id</td><td>string of token to get or NULL to get the first </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>X509 certificate (dynamically allocated) or NULL with wsse:SecurityTokenUnavailable fault </dd></dl>

</div>
</div>
<a class="anchor" id="ae2d977152d826e17bbc58cbd4fddf27a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int soap_wsse_get_KeyInfo_KeyName </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns KeyName element if present. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">soap</td><td>context </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>string or NULL </dd></dl>

</div>
</div>
<a class="anchor" id="a00685f74272f1e5e213e274d004108bc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const unsigned char * soap_wsse_get_KeyInfo_SecurityTokenReferenceKeyIdentifier </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structds_____key_info_type.html">ds__KeyInfoType</a> *&#160;</td>
          <td class="paramname"><em>keyInfo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns KeyInfo/SecurityTokenReference/KeyIdentifier binary data. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">keyInfo</td><td>points to <a class="el" href="structds_____key_info_type.html" title="Imported complexType &quot;http://www.w3.org/2000/09/xmldsig#&quot;:KeyInfoType from typemap WS/WS-typemap...">ds__KeyInfoType</a>, e.g. using soap_wsse_KeyInfo(soap) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">size</td><td>is set to the size of the decoded data </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>data or NULL </dd></dl>

</div>
</div>
<a class="anchor" id="ad3162057a523357a05c9916ba272c139"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char * soap_wsse_get_KeyInfo_SecurityTokenReferenceKeyIdentifierValueType </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structds_____key_info_type.html">ds__KeyInfoType</a> *&#160;</td>
          <td class="paramname"><em>keyInfo</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns KeyInfo/SecurityTokenReference/KeyIdentifier/ValueType if present. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramname">keyInfo</td><td>points to <a class="el" href="structds_____key_info_type.html" title="Imported complexType &quot;http://www.w3.org/2000/09/xmldsig#&quot;:KeyInfoType from typemap WS/WS-typemap...">ds__KeyInfoType</a>, e.g. using soap_wsse_KeyInfo(soap) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>string or NULL </dd></dl>

</div>
</div>
<a class="anchor" id="a0564dbedcbf4e6404c51d14db61db5cb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char * soap_wsse_get_KeyInfo_SecurityTokenReferenceURI </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns a SecurityTokenReference URI if present. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">soap</td><td>context </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>string or NULL </dd></dl>

</div>
</div>
<a class="anchor" id="a53165ba9f316163972af9a839a84da1f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char * soap_wsse_get_KeyInfo_SecurityTokenReferenceValueType </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns a SecurityTokenReference ValueType if present. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">soap</td><td>context </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>string or NULL </dd></dl>

</div>
</div>
<a class="anchor" id="aa35a9b6b69417f40c248cdae560a3dfc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">X509 * soap_wsse_get_KeyInfo_SecurityTokenReferenceX509 </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns a X509 certificate when referenced and present as a BinarySecurity token or when embedded in the signature KeyIdentifier or KeyInfo element. This call must be followed by an X509_free to deallocate the X509 certificate data. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">soap</td><td>context </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>X509 object or NULL with wsse:SecurityTokenUnavailable fault </dd></dl>

</div>
</div>
<a class="anchor" id="a2346304c77d35bd6fb849c8c0e8cea13"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structds_____x509_issuer_serial_type.html">ds__X509IssuerSerialType</a> * soap_wsse_get_KeyInfo_SecurityTokenReferenceX509Data </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns <a class="el" href="structds_____x509_issuer_serial_type.html" title="&quot;http://www.w3.org/2000/09/xmldsig#&quot;:X509IssuerSerialType is a complexType. ">ds__X509IssuerSerialType</a> with non-NULL X509IssuerName and non-NULL X509SerialNumber of a X509Data element when present and set. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">soap</td><td>context </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>pointer to <a class="el" href="structds_____x509_issuer_serial_type.html" title="&quot;http://www.w3.org/2000/09/xmldsig#&quot;:X509IssuerSerialType is a complexType. ">ds__X509IssuerSerialType</a> struct or NULL </dd></dl>

</div>
</div>
<a class="anchor" id="af64d7a9e7d03a291e1421459ca227254"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char * soap_wsse_get_SecurityContextToken </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns wsc:SecurityContextToken/Identifier string value or NULL. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">soap</td><td>context </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>wsc:SecurityContextToken/Identifier string value value or NULL </dd></dl>

</div>
</div>
<a class="anchor" id="a09e16b1618a55f17603691ba3c27dea0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int soap_wsse_get_SignedInfo_SignatureMethod </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>alg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>bits</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get SignatureMethod algorithm. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">alg</td><td>is a signature algorithm, such as SOAP_SMD_HMAC_SHA1/224/256/384/512, SOAP_SMD_VRFY_DSA_SHA1/256, SOAP_SMD_VRFY_RSA_SHA1/224/256/384/512 or SOAP_SMD_ECDSA_SHA1/224/256/384/512 </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">bits</td><td>is set to HMACOutputLength if present and valid, 0 otherwise </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>SOAP_OK or SOAP_FAULT with wsse:UnsupportedAlgorithm, wsse:FailedCheck, or wsse__InvalidSecurity fault </dd></dl>

</div>
</div>
<a class="anchor" id="aca3fe6fb7c1e5c103827b33f24292f47"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char * soap_wsse_get_Username </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns UsernameToken/username string or wsse:FailedAuthentication fault. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">soap</td><td>context </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>UsernameToken/username string or NULL with wsse:FailedAuthentication fault error set </dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="wsseapi_8c.html#ac8883e13b448313da65906fd0f5eb16f" title="Verifies the supplied password or sets wsse:FailedAuthentication fault. ">soap_wsse_verify_Password</a></dd></dl>
<p>The returned username should be used to lookup the user's password in a dictionary or database for server-side authentication with soap_wsse_verify_Password. </p>

</div>
</div>
<a class="anchor" id="afd81efa4868e56854ec3552252641711"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structds_____key_info_type.html">ds__KeyInfoType</a> * soap_wsse_KeyInfo </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns KeyInfo element if present. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">soap</td><td>context </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>ds__KeyInfo object or NULL </dd></dl>

</div>
</div>
<a class="anchor" id="abb37bd1642b6028f96f99ef7e9525c12"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void soap_wsse_rand_nonce </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>nonce</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>noncelen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates randomized nonce. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">nonce</td><td>value [0..noncelen-1] </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">noncelen</td><td>length of nonce must be multiple of 4 </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a7590c46443ff1c74365091d2d7806829"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int soap_wsse_receiver_fault </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>faultstring</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>faultdetail</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets receiver SOAP Fault for server fault response. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">faultstring</td><td>fault string </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">faultdetail</td><td>detail string </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>SOAP_FAULT </dd></dl>

</div>
</div>
<a class="anchor" id="a5cec82648247163c63a28d624b2b9fe8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int soap_wsse_receiver_fault_subcode </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>faultsubcode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>faultstring</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>faultdetail</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets receiver SOAP Fault (sub)code for server fault response. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">faultsubcode</td><td>sub code string </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">faultstring</td><td>fault string </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">faultdetail</td><td>detail string </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>SOAP_FAULT </dd></dl>

</div>
</div>
<a class="anchor" id="ae7775b49a0cd57c7cf85db7bb18b034d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct__wsse_____security.html">_wsse__Security</a> * soap_wsse_Security </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns Security header element if present. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">soap</td><td>context </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="struct__wsse_____security.html" title="This element defines the wsse:Security SOAP header element per Section 4. Imported element _wsse__Sec...">_wsse__Security</a> object or NULL </dd></dl>

</div>
</div>
<a class="anchor" id="a0e7d820ea5bf71efb136bb7f0ffbb71f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int soap_wsse_sender_fault </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>faultstring</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>faultdetail</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets sender SOAP Fault for server fault response. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">faultstring</td><td>fault string </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">faultdetail</td><td>detail string </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>SOAP_FAULT </dd></dl>

</div>
</div>
<a class="anchor" id="aac4234bd51599c36aec7bf7888191fb0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int soap_wsse_sender_fault_subcode </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>faultsubcode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>faultstring</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>faultdetail</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets sender SOAP Fault (sub)code for server fault response. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">faultsubcode</td><td>sub code string </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">faultstring</td><td>fault string </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">faultdetail</td><td>detail string </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>SOAP_FAULT </dd></dl>

</div>
</div>
<a class="anchor" id="a7a1670c6ee444704c8fb7ac612db37ff"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int soap_wsse_set_InclusiveNamespaces </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>prefixlist</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets the C14N InclusiveNamespaces Prefix List property. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">prefixlist</td><td>string of space-separated namespace prefixes, or NULL to remove </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>SOAP_OK </dd></dl>

</div>
</div>
<a class="anchor" id="ad6a0b722a052aaa7652cba5245f78b5f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">soap_wsse_set_security_token_handler </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *(*)(struct soap *, int *alg, const char *keyname, const unsigned char *keyid, int keyidlen, int *keylen)&#160;</td>
          <td class="paramname"><em>callback</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets the security token handler callback that is optionaly used to retrieve keys for signature verification and decryption. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">callback</td><td>function pointer </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>SOAP_OK </dd></dl>

</div>
</div>
<a class="anchor" id="a9582748dda80d0307e253f1a86c0c454"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int soap_wsse_set_wsu_id </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>tags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets the elements that are to be extended with wsu:Id attributes. The wsu:Id attribute values are set to the string value of the tag's QName by replacing colons with hyphens to produce an xsd:ID value. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tags</td><td>string of space-separated qualified and unqualified element tag names </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>SOAP_OK </dd></dl>

</div>
</div>
<a class="anchor" id="aa3ac2afb86a25ec1e1d8e4515133e9ad"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int soap_wsse_sign </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>alg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>keylen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Uses the wsse plugin to sign all wsu:Id attributed elements. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">alg</td><td>is the signature algorithm, such as SOAP_SMD_HMAC_SHA1/224/256/384/512, SOAP_SMD_SIGN_DSA_SHA1/256, SOAP_SMD_SIGN_RSA_SHA1/224/256/384/512, or SOAP_SMD_SIGN_ECDSA_SHA1/224/256/384/512 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">key</td><td>is the HMAC secret key or DSA/RSA/ECDSA private EVP_PKEY </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">keylen</td><td>is the HMAC key length </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>SOAP_OK or fault</dd></dl>
<p>This function does not actually sign the message, but initiates the plugin's signature algorithm to sign the message upon message transfer. </p>

</div>
</div>
<a class="anchor" id="ab653754f1a287ba06bd808cf89548c38"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int soap_wsse_sign_body </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>alg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>keylen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Uses the wsse plugin to sign all wsu:Id attributed elements, including the SOAP Body (by adding a wsu:Id="Body" attribute). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">alg</td><td>is the signature algorithm, such as SOAP_SMD_HMAC_SHA1/224/256/384/512, SOAP_SMD_SIGN_DSA_SHA1/256, SOAP_SMD_SIGN_RSA_SHA1/224/256/384/512, or SOAP_SMD_SIGN_ECDSA_SHA1/224/256/384/512 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">key</td><td>is the HMAC secret key or DSA/RSA/ECDSA private EVP_PKEY </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">keylen</td><td>is the HMAC key length </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>SOAP_OK or fault</dd></dl>
<p>This function does not actually sign the message, but initiates the plugin's signature algorithm to sign the message upon message transfer. </p>

</div>
</div>
<a class="anchor" id="a16e38c1160a47ad2cb60d1b7d5dba777"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int soap_wsse_sign_only </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>tags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Filters only the specified wsu:Id names for signing. Can be used with <a class="el" href="wsseapi_8c.html#a5aecbf5ab1b06aee118f149189a4008b" title="Sets the elements that are to be extended with wsu:Id attributes. The wsu:Id attribute values are set...">soap_wsse_set_wsu_id()</a> and if so should use the element tag names. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tags</td><td>string of space-separated qualified and unqualified tag names </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>SOAP_OK </dd></dl>

</div>
</div>
<a class="anchor" id="a04dd8f3dc19f5ba511f638c59f6b6ee8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structds_____signature_type.html">ds__SignatureType</a> * soap_wsse_Signature </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns Signature header element if present. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">soap</td><td>context </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="structds_____signature_type.html">ds__SignatureType</a> object or NULL </dd></dl>

</div>
</div>
<a class="anchor" id="a98940306a4dd6074efc2e3ff9c899ba9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structds_____signed_info_type.html">ds__SignedInfoType</a> * soap_wsse_SignedInfo </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns SignedInfo element if present. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">soap</td><td>context </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="structds_____signed_info_type.html" title="&quot;http://www.w3.org/2000/09/xmldsig#&quot;:SignedInfoType is a complexType. ">ds__SignedInfoType</a> object or NULL </dd></dl>

</div>
</div>
<a class="anchor" id="a04c4d2e02fd8580ff632410f918f7796"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct__wsu_____timestamp.html">_wsu__Timestamp</a> * soap_wsse_Timestamp </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns Timestamp element if present. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">soap</td><td>context </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="struct__wsu_____timestamp.html" title="This element allows Timestamps to be applied anywhere element wildcards are present, including as a SOAP header. Imported element _wsu__Timestamp from typemap WS/WS-typemap.dat. ">_wsu__Timestamp</a> object or NULL </dd></dl>

</div>
</div>
<a class="anchor" id="ae74d27ca59d97961711a038b7188ceb6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct__wsse_____username_token.html">_wsse__UsernameToken</a> * soap_wsse_UsernameToken </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns UsernameToken element if present. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">id</td><td>string of UsernameToken or NULL </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="struct__wsse_____username_token.html" title="This element defines the wsse:UsernameToken element per Section 4.1. Imported element _wsse__Username...">_wsse__UsernameToken</a> object or NULL</dd></dl>
<dl class="section note"><dt>Note</dt><dd>This release supports the use of at most one UsernameToken in the header. </dd></dl>

</div>
</div>
<a class="anchor" id="a7321b451910e1d3887b328f03de92f34"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int soap_wsse_verify_auto </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>alg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>keylen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Uses the wsse plugin to initiate the automatic verification of the signature and SignedInfo Reference digests. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">alg</td><td>to verify signature if signature has no secret or public key, use SOAP_SMD_NONE to omit </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">key</td><td>is HMAC key or a DSA/RSA/ECDSA EVP_PKEY or NULL </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">keylen</td><td>is HMAC key length or 0 </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>SOAP_OK</dd></dl>
<p>This function does not actually verify the message, but initiates the plugin's algorithm to store the message in a DOM to automatically verify the signature and digests. If the message does not contain a key to verify the signature, the alg, key, and keylen parameters are used. It is important that the X509 certificate used to verify the signature, which requires soap-&gt;cafile and/or soap-&gt;capath to be set. </p>

</div>
</div>
<a class="anchor" id="a5ccbce0f1a4a8f103e921a918f932a20"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int soap_wsse_verify_body </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Post-checks the presence of signed SOAP Body. Does not verify the signature of the Body, which is done with <a class="el" href="wsseapi_8c.html#aba1ed2878f44b2c4efac24cd89ff30bf">soap_wsse_verify_auto</a>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">soap</td><td>context </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>SOAP_OK (signed) or SOAP_FAULT</dd></dl>
<p>This function does not actually verify the signature of the Body. It checks whether the Body is signed and thus its integrity is preserved. Clients should call this function after invocation. Services should call this function inside a service operation. This function traverses the entire DOM, so performance is determined by the size of a message. </p>

</div>
</div>
<a class="anchor" id="acf1c213ea26a2286f9c0457849bd6290"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int soap_wsse_verify_digest </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>alg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>canonical</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char&#160;</td>
          <td class="paramname"><em>hash</em>[SOAP_SMD_MAX_SIZE]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Verifies the digest value of an XML element referenced by id against the hash. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">alg</td><td>digest algorithm </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">canonical</td><td>flag indicating that element is signed in c14n (inclusive or exclusive) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">id</td><td>string of the XML element to verify </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hash</td><td>digest value to verify against </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>SOAP_OK or fault </dd></dl>

</div>
</div>
<a class="anchor" id="a07db8f284ab2bb564248999fe02d0169"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int soap_wsse_verify_done </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Terminates the automatic verification of signatures. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">soap</td><td>context </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>SOAP_OK </dd></dl>

</div>
</div>
<a class="anchor" id="a3fbe81de521579f026dd1ba8e81c59c1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t soap_wsse_verify_element </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>URI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>tag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Post-checks the presence of signed element(s), returns the number of matching elements signed or zero when none found or if one or more matching elements are not signed. Does not verify the signature of these elements, which is done with <a class="el" href="wsseapi_8c.html#aba1ed2878f44b2c4efac24cd89ff30bf">soap_wsse_verify_auto</a>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramname">URI</td><td>namespace of element(s) </td></tr>
    <tr><td class="paramname">tag</td><td>name of element(s) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>number of matching elements that are signed or 0 if no matching elements found or if one or more non-signed matching elements were found (0 is returned to prevent signature wrapping attacks).</dd></dl>
<p>This function does not actually verify the signature of each element, but checks whether the elements are signed and thus their integrity is preserved. Signed element nesting rules are obeyed, so if the matching element is a descendent of a signed element, it is signed as well. Thus, the verification process follows nesting rules.</p>
<p>Client should call this function after invocation. Services should call this function inside a service operation. This function traverses the entire DOM, so performance is determined by the size of a message.</p>
<p>To check the SOAP Body (either using SOAP 1.1 or 1.2), <a class="el" href="wsseapi_8c.html#a5e158e7c3e97c336b25bdcbb3598ce01">soap_wsse_verify_element</a>(soap, namespaces[0].ns, "Body"). To check whether the Timestamp was signed (assuming it is present and message expiration checked with <a class="el" href="wsseapi_8c.html#a1788006a119b3d4ad7fc11d12d6a880d">soap_wsse_verify_Timestamp</a>), use <a class="el" href="wsseapi_8c.html#a5e158e7c3e97c336b25bdcbb3598ce01">soap_wsse_verify_element</a>(soap, "http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd", "Timestamp").</p>
<dl class="section note"><dt>Note</dt><dd>For future releases, XPath queries (or forms of these) will be considered. </dd></dl>

</div>
</div>
<a class="anchor" id="afcfdd54e7c220fb90e11c75da3bbbe88"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int soap_wsse_verify_EncryptedKey </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Verifies the EncryptedKey header information (certificate validity requires soap-&gt;cafile to be set). Retrieves the decryption key from the token handler callback to decrypt the decryption key. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">soap</td><td>context </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>SOAP_OK or error code </dd></dl>

</div>
</div>
<a class="anchor" id="a8a246ebd371d9e92c74ec1e29bf92f3a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int soap_wsse_verify_init </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Uses the wsse plugin to initiate the verification of the signature and SignedInfo Reference digests. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">soap</td><td>context </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>SOAP_OK</dd></dl>
<p>This function does not actually verify the message, but initiates the plugin's data to store the message in a DOM to verify the signature. The signature and digests in the DOM must be verified manually. </p>

</div>
</div>
<a class="anchor" id="aeb0afd01a5036e4f1314a3cfe8575bd5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int soap_wsse_verify_Password </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>password</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Verifies the supplied password or sets wsse:FailedAuthentication fault. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">password</td><td>string to verify against </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>SOAP_OK (authorized) or SOAP_FAULT with wsse:FailedAuthentication fault</dd></dl>
<p>The verification supports both clear-text password verification and digest password authentication. For digest authentication a history mechanism with a digest authentication session database ensures protection against replay attacks.</p>
<dl class="section note"><dt>Note</dt><dd>This release supports the use of at most one UsernameToken in the header. </dd></dl>

</div>
</div>
<a class="anchor" id="a1267cd7ba1fa1dc0f38fd75f74503308"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int soap_wsse_verify_Signature </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Verifies the Signature and the signed elements. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">soap</td><td>context </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>SOAP_OK, SOAP_EOM, or fault </dd></dl>

</div>
</div>
<a class="anchor" id="a8ab7e709b0423cd68d3fec96b3db3734"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int soap_wsse_verify_SignatureValue </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>alg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>keylen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Verifies the SignatureValue of a SignedInfo element. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">alg</td><td>is a signature algorith, such as SOAP_SMD_HMAC_SHA1/224/256/384/512, SOAP_SMD_VRFY_DSA_SHA1/256, SOAP_SMD_VRFY_RSA_SHA1/224/256/384/512 or SOAP_SMD_VRFY_ECDSA_SHA1/224/256/384/512 determined by the SignedInfo/SignatureMethod </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">key</td><td>to use to verify (HMAC or DSA/RSA/ECDSA EVP_PKEY) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">keylen</td><td>length of HMAC key </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>SOAP_OK, SOAP_EOM, or fault</dd></dl>
<p>This function searches for the SignedInfo element in the soap-&gt;dom DOM tree to verify the signature in the SignatureValue element. Using the DOM ensures we will verify the signature of a SignedInfo as it was exactly received by the parser, by using the -DWITH_DOM compile flag and SOAP_XML_DOM runtime flag. If there is no DOM, it verifies the signature of the deserialized SignedInfo element in the SOAP Header. However, serializing deserialized data may change the octet stream that was signed, unless we're using gSOAP as producers and consumers (with the SOAP_XML_INDENT flag reset). </p>

</div>
</div>
<a class="anchor" id="a75b7ca484637dfc49143546072dd5f4b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int soap_wsse_verify_SignedInfo </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Verifies the digest values of the XML elements referenced by the SignedInfo References. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">soap</td><td>context </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>SOAP_OK or fault</dd></dl>
<p>This function searches for the SignedInfo element in the soap-&gt;dom DOM tree to verify the digests contained therein. Using the DOM ensures we will verify the digests of the locally signed elements as they were exactly received by the parser, by using the -DWITH_DOM compile flag and SOAP_XML_DOM runtime flag. If there is no DOM, the function fails. </p>

</div>
</div>
<a class="anchor" id="a98422cde0e2b7b14d65212f7061101fa"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int soap_wsse_verify_Timestamp </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Verifies the Timestamp/Expires element against the current time. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">soap</td><td>context </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>SOAP_OK or SOAP_FAULT with wsu:MessageExpired fault</dd></dl>
<p>Sets wsu:MessageExpired fault if wsu:Timestamp is expired. The SOAP_WSSE_CLKSKEW value is used as a margin to mitigate clock skew. Keeps silent when no timestamp is supplied or no expiration date is included in the wsu:Timestamp element. </p>

</div>
</div>
<a class="anchor" id="a9683d6e2780bf1d679e191ea18591cbc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SOAP_FMAC1 int SOAP_FMAC2 soap_wsse_verify_with_signature </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ds_8h.html#a27725fd6615422a64169b1c0ad87b8fa">_ds__Signature</a> *&#160;</td>
          <td class="paramname"><em>signature</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a8f5879e7d5bd3580ea400ccd1982d747"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int soap_wsse_verify_X509 </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">X509 *&#160;</td>
          <td class="paramname"><em>cert</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Verifies X509 certificate against soap-&gt;cafile, soap-&gt;capath, and soap-&gt;crlfile. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cert</td><td>X509 certificate </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>SOAP_OK or fault</dd></dl>
<p>This is an expensive operation. Whenever a new soap context is created, the cafile and objects are loaded into that context each time we need to verify a certificate. </p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a class="anchor" id="a4089697df0f14ecf44cf0fb6098f4f78"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* c14n_URI</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a1f62c1715e0f49fd54ffc263e45a12eb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* ds_dsa_sha1URI</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a352a6e78890296ade9e25de397f1096c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* ds_hmac_sha1URI</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="ab356216a1331e0ba33de2a62d1c8b5fb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* ds_hmac_sha256URI</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a73b877c9a2879fcc6bfd311150beccbd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* ds_hmac_sha512URI</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="ad57129724eb01a743b6583afc522a131"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* ds_rsa_sha1URI</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a739fd4e4c86b17b58877a672bec79bc3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* ds_rsa_sha256URI</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a6f17cf69547d2ead56934e89f10f3ba6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* ds_rsa_sha512URI</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a71140ac907117b2bbf37f14939166a15"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* ds_sha1URI</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a99bf1005a6700b2e94cc400f799f4b93"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* ds_sha256URI</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a752690ab049714713ae0d240c0a11350"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* ds_sha512URI</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="ad7aea4af6b24389f66019e8984d4b05c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* ds_URI</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="af798c8221c5bdc2e45bd27a52e02c79f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char soap_wsse_id[]</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>plugin identification for plugin registry</p>
<p>Plugin identification for plugin registry </p>

</div>
</div>
<a class="anchor" id="a7d0ae8f2dd1beaabdaa4884ea5dd41e4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* wsse_Base64BinaryURI</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a000638936fff26e30a3f256c495c1aa8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* wsse_PasswordDigestURI</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a38dfc9981f0859b1307c302d8497c08c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* wsse_PasswordTextURI</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a88d310451ae729bbf0fdd149a9d7511c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* wsse_X509v3SubjectKeyIdentifierURI</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="ac07968b1c372e976758745ba7089c367"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* wsse_X509v3URI</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="adb66cffe8d95c5d511987189173a993c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* wsu_URI</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a159d359ac83617f624b54d467db4e0b1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* xenc_3desURI</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="ae62c2754ffb9473f23a83d03f9bd0066"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* xenc_aes128cbcURI</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a5251082fa5d641366794c3c2eb87a634"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* xenc_aes128gcmURI</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a1c03789019f942f38a52b7cf3e3261f9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* xenc_aes192cbcURI</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="ac5a138d550595ab0103f5ea0b899ceac"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* xenc_aes192gcmURI</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a980c3cf82e86c8b0643c92ef785384f3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* xenc_aes256cbcURI</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a7852df271f5783819a53fc3ee247ace2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* xenc_aes256gcmURI</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a1093ef00c10baa0d9ac3c01858fc37ee"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* xenc_aes512cbcURI</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a6c3be5abe1067c475336bd84ff769ef1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* xenc_aes512gcmURI</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="abc58fc5b358c1f06737a623788dbfa0e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* xenc_contentURI</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a4fdac00892919c46ed53fa05b9cc0bdf"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* xenc_elementURI</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a6c5bdcb80c33d0c3d35050091bd2cec5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* xenc_rsa15URI</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a43c42203ea88ef920b653d90307e6731"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* xenc_rsaesURI</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
<hr class="footer">
<address class="footer">
Copyright (C) 2020, Robert van Engelen, Genivia Inc., All Rights Reserved.
</address>
<address class="footer"><small>
Converted on Thu Nov 19 2020 12:38:39 by <a target="_blank" href="http://www.doxygen.org/index.html">Doxygen</a> 1.8.11</small></address>
<br>
<div style="height: 246px; background: #DBDBDB;">
</body>
</html>
